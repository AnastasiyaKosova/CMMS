<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CMMS ‚Äî –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ–º</title>
<style>
  body {margin:0; font-family: Inter, sans-serif; background: #0f1724; color: #e6eef6; display:flex; justify-content:center; align-items:flex-start; padding-top:20px;}
  .screen {display:none; padding:20px; border-radius:12px; background: #0b1220; width:95%; max-width:1200px; box-shadow:0 6px 18px rgba(2,6,23,0.6);}
  .active {display:block;}
  
  .admin-panel { background: #1e293b; border-left: 4px solid #06b6d4; }
  .question-item { background: rgba(255,255,255,0.03); padding: 12px; margin: 8px 0; border-radius: 8px; }
  .results-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
  .results-table th { background: rgba(6,182,212,0.1); padding: 10px; text-align: left; }
  .results-table td { padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); }
  
  input, textarea, select {width:100%; padding:8px; margin-bottom:12px; border-radius:8px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:#e6eef6;}
  button {padding:10px 16px; border:none; border-radius:10px; background:#06b6d4; color:#052026; cursor:pointer; margin:4px;}
  .btn-danger {background:#ef4444;}
  .btn-success {background:#10b981;}
  .btn-secondary {background:#64748b;}
  .btn-warning {background:#f59e0b;}
  .note {font-size:12px; color:#94a3b8; margin-bottom:12px;}
  .card {background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.04)); border-radius:12px; padding:14px; box-shadow:0 6px 18px rgba(2,6,23,0.6); margin-bottom:12px;}
  
  .admin-dashboard { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
  .admin-card { background: rgba(255,255,255,0.03); padding: 20px; border-radius: 12px; text-align: center; }
  .admin-card h3 { margin-top: 0; }
  
  .equipment-buttons { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
  .equipment-btn { 
    background: rgba(255,255,255,0.05); 
    border: 2px solid rgba(255,255,255,0.1);
    border-radius: 12px; 
    padding: 25px 15px; 
    color: #e6eef6; 
    cursor: pointer; 
    transition: all 0.3s ease;
    font-size: 16px;
    font-weight: 600;
  }
  .equipment-btn:hover {
    background: rgba(6,182,212,0.2);
    border-color: #06b6d4;
    transform: translateY(-2px);
  }
  
  .loading { opacity: 0.6; pointer-events: none; }
  
  .category-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }

  /* –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —ç–∫—Ä–∞–Ω–∞ –≠–ö–ì */
  .equipment-item {
    padding: 12px;
    margin: 5px 0;
    background: rgba(255,255,255,0.03);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 1px solid rgba(255,255,255,0.05);
  }

  .equipment-item:hover {
    background: rgba(6,182,212,0.1);
    border-color: #06b6d4;
  }

  .equipment-item.selected {
    background: rgba(6,182,212,0.2);
    border-color: #06b6d4;
  }

  .record-item {
    padding: 15px;
    margin: 10px 0;
    background: rgba(255,255,255,0.02);
    border-radius: 8px;
    border-left: 4px solid #06b6d4;
  }

  .operations-panel {
    flex: 0 0 250px;
  }

  .main-content {
    flex: 1;
  }
</style>
</head>
<body>

<!-- –≠–∫—Ä–∞–Ω 1: –í—Ö–æ–¥ -->
<div id="login-screen" class="screen active">
  <h2>–í—Ö–æ–¥ –≤ CMMS</h2>
  <input id="login" type="text" placeholder="–õ–æ–≥–∏–Ω">
  <input id="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
  <button id="login-btn">–í–æ–π—Ç–∏</button>
  <div id="login-msg" class="note"></div>
  <div class="note">
    <strong>–¢–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:</strong><br>
    üëë –ê–¥–º–∏–Ω: admin / admin123<br>
    ‚öôÔ∏è –ò–Ω–∂–µ–Ω–µ—Ä: engineer / engineer123
  </div>
</div>

<!-- –≠–∫—Ä–∞–Ω 2: –ê–¥–º–∏–Ω –î–∞—à–±–æ—Ä–¥ -->
<div id="admin-dashboard-screen" class="screen admin-panel">
  <h2>üëë –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
  
  <div class="admin-dashboard">
    <div class="admin-card">
      <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—É—á–µ–Ω–∏—è</h3>
      <p>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</p>
      <button id="admin-setup-btn">–ü–µ—Ä–µ–π—Ç–∏ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º</button>
    </div>
    
    <div class="admin-card">
      <h3>üõ†Ô∏è –†–∞–±–æ—á–µ–µ –æ–∫–Ω–æ</h3>
      <p>–î–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º —Å–∏—Å—Ç–µ–º—ã</p>
      <button id="admin-workspace-btn">–ü–µ—Ä–µ–π—Ç–∏ –≤ —Ä–∞–±–æ—á–µ–µ –æ–∫–Ω–æ</button>
    </div>
  </div>

  <div class="card">
    <h3>üìä –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø</h3>
    <button id="view-results-btn">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤</button>
    <button id="manage-users-btn">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</button>
    <button id="system-status-btn">–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</button>
  </div>

  <button class="btn-secondary" id="logout-admin">üö™ –í—ã–π—Ç–∏</button>
</div>

<!-- –≠–∫—Ä–∞–Ω 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ -->
<div id="admin-setup-screen" class="screen admin-panel">
  <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—É—á–∞—é—â–∏—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</h2>
  
  <div class="card">
    <h3>üìö –£—á–µ–±–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª</h3>
    <textarea id="training-material" rows="10" placeholder="–í–≤–µ–¥–∏—Ç–µ —É—á–µ–±–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª (–º–æ–∂–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ Word)...">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É CMMS. –≠—Ç–æ –±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã...</textarea>
  </div>
  
  <div class="card">
    <h3>‚ùì –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (10 –≤–æ–ø—Ä–æ—Å–æ–≤)</h3>
    <div id="questions-container">
      <!-- –í–æ–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
    </div>
    <button id="add-question-btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å</button>
  </div>
  
  <button id="save-training-btn" class="btn-success">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ</button>
  <button class="btn-secondary" id="back-to-admin-dashboard">‚Üê –ù–∞–∑–∞–¥ –≤ –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</button>
</div>

<!-- –≠–∫—Ä–∞–Ω 4: –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
<div id="results-screen" class="screen admin-panel">
  <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</h2>
  <table class="results-table" id="results-table">
    <thead>
      <tr>
        <th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
        <th>–î–∞—Ç–∞ —Ç–µ—Å—Ç–∞</th>
        <th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
        <th>–°—Ç–∞—Ç—É—Å</th>
      </tr>
    </thead>
    <tbody id="results-body">
    </tbody>
  </table>
  <button class="btn-secondary" id="back-to-admin-from-results">‚Üê –ù–∞–∑–∞–¥ –≤ –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</button>
</div>

<!-- –≠–∫—Ä–∞–Ω 5: –ò–∑—É—á–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ -->
<div id="study-screen" class="screen">
  <h2>üìñ –û–±—É—á–∞—é—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</h2>
  <div id="study-content" class="card">
    <!-- –ú–∞—Ç–µ—Ä–∏–∞–ª –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∑–¥–µ—Å—å -->
  </div>
  <button id="start-test-btn">üéØ –ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é</button>
  <button class="btn-secondary" id="logout-study">üö™ –í—ã–π—Ç–∏</button>
</div>

<!-- –≠–∫—Ä–∞–Ω 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ -->
<div id="test-screen" class="screen">
  <h2>üß† –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞–Ω–∏–π</h2>
  <div id="test-progress">–í–æ–ø—Ä–æ—Å 1 –∏–∑ 10</div>
  <div class="card">
    <h3 id="question-text">–í–æ–ø—Ä–æ—Å –±—É–¥–µ—Ç –∑–¥–µ—Å—å</h3>
    <input type="text" id="answer-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç...">
  </div>
  <button id="next-question-btn">–î–∞–ª–µ–µ ‚Üí</button>
  <div id="test-msg" class="note"></div>
</div>

<!-- –≠–∫—Ä–∞–Ω 7: –†–ê–ë–û–ß–ï–ï –û–ö–ù–û –° –û–ë–û–†–£–î–û–í–ê–ù–ò–ï–ú -->
<div id="workspace-screen" class="screen">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
    <h2 style="margin: 0;">üõ†Ô∏è –†–∞–±–æ—á–µ–µ –æ–∫–Ω–æ CMMS</h2>
    <div style="display: flex; gap: 10px; align-items: center;">
      <span id="current-user-role"></span>
      <button class="btn-secondary" id="logout-workspace">üö™ –í—ã–π—Ç–∏</button>
    </div>
  </div>

  <div style="display: flex; gap: 20px;">
    <!-- –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨ - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ -->
    <div style="flex: 0 0 300px;">
      <div id="admin-workspace-features" style="display: none; margin-bottom: 20px;">
        <div class="card">
          <h3>üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</h3>
          <div style="display: flex; flex-direction: column; gap: 8px;">
            <button class="equipment-btn" style="width: 100%; text-align: left;" onclick="showUserManagement()">
              üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
            </button>
            <button class="equipment-btn" style="width: 100%; text-align: left;" onclick="showSystemSettings()">
              ‚öôÔ∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            </button>
            <button class="equipment-btn" style="width: 100%; text-align: left;" onclick="ScreenManager.show('admin-setup-screen')">
              üìö –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ
            </button>
            <button class="equipment-btn" style="width: 100%; text-align: left;" onclick="showAddEquipmentForm()">
              ‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
            </button>
            <button class="equipment-btn" style="width: 100%; text-align: left;" onclick="generateReport()">
              üìÑ –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç
            </button>
            <button class="equipment-btn" style="width: 100%; text-align: left;" onclick="ScreenManager.show('results-screen')">
              üìä –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            </button>
          </div>
        </div>
      </div>

      <!-- –ë–ª–æ–∫ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
      <div id="user-workspace-features" style="display: none;">
        <div class="card">
          <h3>‚öôÔ∏è –§—É–Ω–∫—Ü–∏–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h3>
          <div style="display: flex; flex-direction: column; gap: 8px;">
            <button class="equipment-btn" style="width: 100%; text-align: left;" onclick="ScreenManager.show('study-screen')">
              üìñ –û–±—É—á–∞—é—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
            </button>
            <button class="equipment-btn" style="width: 100%; text-align: left;" onclick="startEmployeeTest()">
              üß† –ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
            </button>
            <button class="equipment-btn" style="width: 100%; text-align: left;" onclick="generateUserReport()">
              üìä –ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- –û–°–ù–û–í–ù–û–ô –ë–õ–û–ö - –ö–Ω–æ–ø–∫–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è -->
    <div style="flex: 1;">
      <div class="card">
        <h3>üè≠ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º</h3>
        <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã</p>
        
        <div class="equipment-buttons">
          <button class="equipment-btn" onclick="openEquipmentCategory('–≠–ö–ì')">
            üèóÔ∏è –≠–∫—Å–∫–∞–≤–∞—Ç–æ—Ä—ã (–≠–ö–ì)
          </button>
          <button class="equipment-btn" onclick="openEquipmentCategory('–ë–µ–ª–ê–∑—ã')">
            üöõ –ö–∞—Ä—å–µ—Ä–Ω—ã–µ —Å–∞–º–æ—Å–≤–∞–ª—ã (–ë–µ–ª–ê–∑—ã)
          </button>
          <button class="equipment-btn" onclick="openEquipmentCategory('–ë—É—Ä–æ–≤—ã–µ')">
            ‚õèÔ∏è –ë—É—Ä–æ–≤—ã–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
          </button>
          <button class="equipment-btn" onclick="openEquipmentCategory('–í–æ–¥–æ–æ—Ç–ª–∏–≤')">
            üíß –°–∏—Å—Ç–µ–º—ã –≤–æ–¥–æ–æ—Ç–ª–∏–≤–∞
          </button>
          <button class="equipment-btn" onclick="openEquipmentCategory('–°–µ—Ç–∏')">
            üîå –°–ª—É–∂–±–∞ —Å–µ—Ç–µ–π
          </button>
        </div>
      </div>

      <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
      <div class="card" style="margin-top: 20px;">
        <h3>üìà –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø</h3>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
          <div>
            <strong>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:</strong>
            <div style="margin-top: 10px; font-size: 14px;">
              <div>‚Ä¢ –ü—Ä–∏–Ω—è—Ç–∞ —Å–º–µ–Ω–∞ –≠–ö–ì-1</div>
              <div>‚Ä¢ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—å</div>
              <div>‚Ä¢ –ü—Ä–æ–≤–µ–¥–µ–Ω —Ä–µ–º–æ–Ω—Ç</div>
            </div>
          </div>
          <div>
            <strong>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ–≥–æ–¥–Ω—è:</strong>
            <div style="margin-top: 10px; font-size: 14px;">
              <div>‚Ä¢ –ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–º–µ–Ω: 3</div>
              <div>‚Ä¢ –ù–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π: 2</div>
              <div>‚Ä¢ –í—ã–ø–æ–ª–Ω–µ–Ω–æ —Ä–µ–º–æ–Ω—Ç–æ–≤: 1</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- –≠–ö–†–ê–ù 8: –≠–ö–°–ö–ê–í–ê–¢–û–†–´ –≠–ö–ì -->
<div id="ekg-screen" class="screen">
  <div class="category-header">
    <h2>üèóÔ∏è –≠–∫—Å–∫–∞–≤–∞—Ç–æ—Ä—ã –≠–ö–ì</h2>
    <button class="btn-secondary" onclick="ScreenManager.show('workspace-screen')">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</button>
  </div>

  <!-- –®–ê–ü–ö–ê (–û–∫–Ω–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è) -->
  <div class="card" style="margin-bottom: 20px;">
    <h3>üìä –û–∫–Ω–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</h3>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
      <div>
        <strong>–¢–µ–∫—É—â–∏–π —ç–∫—Å–∫–∞–≤–∞—Ç–æ—Ä:</strong> 
        <select id="current-excavator" style="margin: 8px 0;">
          <option value="–≠–ö–ì-1">–≠–ö–ì-1</option>
          <option value="–≠–ö–ì-2">–≠–ö–ì-2</option>
          <option value="–≠–ö–ì-3">–≠–ö–ì-3</option>
          <option value="–≠–ö–ì-4">–≠–ö–ì-4</option>
        </select>
      </div>
      <div>
        <strong>–°—Ç–∞—Ç—É—Å:</strong> <span style="color: #10b981;">‚óè –í —Ä–∞–±–æ—Ç–µ</span><br>
        <strong>–°–º–µ–Ω–∞:</strong> –î–Ω–µ–≤–Ω–∞—è (08:00-20:00)
      </div>
    </div>
  </div>

  <div style="display: flex; gap: 20px;">
    <!-- –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨ - –°–ø–∏—Å–æ–∫ —Ç–µ—Ö–Ω–∏–∫–∏ -->
    <div style="flex: 0 0 250px;">
      <div class="card">
        <h4>üìã –°–ø–∏—Å–æ–∫ —Ç–µ—Ö–Ω–∏–∫–∏</h4>
        <div id="equipment-list" style="max-height: 400px; overflow-y: auto;">
          <div class="equipment-item" data-id="1" onclick="selectEquipment(1)">1. –≠–ö–ì-1</div>
          <div class="equipment-item" data-id="2" onclick="selectEquipment(2)">2. –≠–ö–ì-2</div>
          <div class="equipment-item" data-id="3" onclick="selectEquipment(3)">3. –≠–ö–ì-3</div>
          <div class="equipment-item" data-id="4" onclick="selectEquipment(4)">4. –≠–ö–ì-4</div>
        </div>
        <button class="btn-success" style="width: 100%; margin-top: 10px;" onclick="showAddEquipmentForm()">
          ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Ö–Ω–∏–∫—É
        </button>
      </div>
    </div>

    <!-- –û–°–ù–û–í–ù–û–ô –ë–õ–û–ö - –ó–∞–ø–∏—Å–∏ —Å–º–µ–Ω—ã -->
    <div style="flex: 1;">
      <div class="card">
        <h3>üìù –ó–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ç–µ—á–µ–Ω–∏–µ —Å–º–µ–Ω—ã –≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π</h3>
        
        <div id="shift-records" style="max-height: 500px; overflow-y: auto;">
          <div class="record-item">
            <div style="display: flex; justify-content: space-between; align-items: start;">
              <div>
                <strong>üïí 08:15</strong> - <span style="color: #f59e0b;">‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—å</span><br>
                <em>–ì–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞: —Ç–µ—á—å –≤ —à–ª–∞–Ω–≥–µ –≤—ã—Å–æ–∫–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è</em>
              </div>
              <span style="color: #ef4444; font-size: 12px;">–ù–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ</span>
            </div>
          </div>
          
          <div class="record-item">
            <div style="display: flex; justify-content: space-between; align-items: start;">
              <div>
                <strong>üïí 10:30</strong> - <span style="color: #10b981;">‚úÖ –ü—Ä–∏–Ω—è—Ç–∞ —Å–º–µ–Ω–∞</span><br>
                <em>–°–º–µ–Ω–∞ –ø—Ä–∏–Ω—è—Ç–∞. –û—Å–º–æ—Ç—Ä –ø—Ä–æ–≤–µ–¥–µ–Ω. –ó–∞–º–µ—á–∞–Ω–∏–π –Ω–µ—Ç.</em>
              </div>
              <span style="color: #10b981; font-size: 12px;">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</span>
            </div>
          </div>
          
          <div class="record-item">
            <div style="display: flex; justify-content: space-between; align-items: start;">
              <div>
                <strong>üïí 12:45</strong> - <span style="color: #06b6d4;">üîß –ü—Ä–æ–≤–µ–¥–µ–Ω —Ä–µ–º–æ–Ω—Ç</span><br>
                <em>–ó–∞–º–µ–Ω–µ–Ω —Ñ–∏–ª—å—Ç—Ä –≥–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã</em>
              </div>
              <span style="color: #10b981; font-size: 12px;">–£—Å—Ç—Ä–∞–Ω–µ–Ω–æ</span>
            </div>
          </div>
        </div>
        
        <div style="margin-top: 15px;">
          <button class="btn-secondary" onclick="addNewRecord()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å</button>
          <button class="btn-warning" onclick="exportShiftReport()">üìÑ –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–∞ —Å–º–µ–Ω—ã</button>
        </div>
      </div>
    </div>

    <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ - –û–ø–µ—Ä–∞—Ü–∏–∏ -->
    <div style="flex: 0 0 250px;">
      <div class="card">
        <h4>‚öôÔ∏è –û–ø–µ—Ä–∞—Ü–∏–∏</h4>
        <button class="equipment-btn" style="width: 100%; text-align: left; margin: 5px 0;" onclick="acceptShift()">
          ‚úÖ –ü—Ä–∏–Ω—è—Ç—å —Å–º–µ–Ω—É
        </button>
        <button class="equipment-btn" style="width: 100%; text-align: left; margin: 5px 0;" onclick="handOverShift()">
          üì§ –°–¥–∞—Ç—å —Å–º–µ–Ω—É
        </button>
        <button class="equipment-btn" style="width: 100%; text-align: left; margin: 5px 0;" onclick="registerMalfunction()">
          ‚ö†Ô∏è –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π
        </button>
        <button class="equipment-btn" style="width: 100%; text-align: left; margin: 5px 0;" onclick="viewMalfunctions()">
          üìä –ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π
        </button>
        <button class="equipment-btn" style="width: 100%; text-align: left; margin: 5px 0;" onclick="resolveMalfunctions()">
          üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π
        </button>
      </div>
    </div>
  </div>
</div>

<!-- –≠–ö–†–ê–ù 9: –ö–ê–†–¨–ï–†–ù–´–ï –°–ê–ú–û–°–í–ê–õ–´ -->
<div id="belaz-screen" class="screen">
  <div class="category-header">
    <h2>üöõ –ö–∞—Ä—å–µ—Ä–Ω—ã–µ —Å–∞–º–æ—Å–≤–∞–ª—ã –ë–µ–ª–ê–∑</h2>
    <button class="btn-secondary" onclick="ScreenManager.show('workspace-screen')">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</button>
  </div>

  <div class="card">
    <h3>–ê–≤—Ç–æ–ø–∞—Ä–∫ –∫–∞—Ä—å–µ—Ä–Ω—ã—Ö —Å–∞–º–æ—Å–≤–∞–ª–æ–≤</h3>
    <p>üöß –†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ - –∑–¥–µ—Å—å –±—É–¥–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–ø–∞—Ä–∫–æ–º –ë–µ–ª–ê–∑</p>
    
    <div style="display: flex; gap: 10px; margin-top: 20px;">
      <button class="btn-success" onclick="alert('–§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏')">
        üöõ –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–≤—Ç–æ–ø–∞—Ä–∫–∞
      </button>
      <button class="btn-warning" onclick="alert('–§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏')">
        üõ†Ô∏è –£—á–µ—Ç –¢–û
      </button>
      <button class="btn-secondary" onclick="alert('–§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏')">
        ‚õΩ –£—á–µ—Ç –ì–°–ú
      </button>
    </div>
  </div>
</div>

<!-- –≠–ö–†–ê–ù 10: –ë–£–†–û–í–´–ï –£–°–¢–ê–ù–û–í–ö–ò -->
<div id="drilling-screen" class="screen">
  <div class="category-header">
    <h2>‚õèÔ∏è –ë—É—Ä–æ–≤—ã–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏</h2>
    <button class="btn-secondary" onclick="ScreenManager.show('workspace-screen')">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</button>
  </div>

  <div class="card">
    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—É—Ä–æ–≤—ã–º–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏</h3>
    <p>üöß –†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ - –∑–¥–µ—Å—å –±—É–¥–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—É—Ä–æ–≤—ã–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º</p>
    
    <div style="display: flex; gap: 10px; margin-top: 20px;">
      <button class="btn-success" onclick="alert('–§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏')">
        üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±—É—Ä–µ–Ω–∏—è
      </button>
      <button class="btn-warning" onclick="alert('–§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏')">
        üîß –£—á–µ—Ç —Ä–µ–º–æ–Ω—Ç–æ–≤
      </button>
      <button class="btn-secondary" onclick="alert('–§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏')">
        üìä –ì–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
      </button>
    </div>
  </div>
</div>

<!-- –≠–ö–†–ê–ù 11: –°–ò–°–¢–ï–ú–´ –í–û–î–û–û–¢–õ–ò–í–ê -->
<div id="drainage-screen" class="screen">
  <div class="category-header">
    <h2>üíß –°–∏—Å—Ç–µ–º—ã –≤–æ–¥–æ–æ—Ç–ª–∏–≤–∞</h2>
    <button class="btn-secondary" onclick="ScreenManager.show('workspace-screen')">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</button>
  </div>

  <div class="card">
    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–∞–º–∏ –≤–æ–¥–æ–æ—Ç–ª–∏–≤–∞</h3>
    <p>üöß –†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ - –∑–¥–µ—Å—å –±—É–¥–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å–æ—Å–Ω—ã–º–∏ —Å—Ç–∞–Ω—Ü–∏—è–º–∏</p>
    
    <div style="display: flex; gap: 10px; margin-top: 20px;">
      <button class="btn-success" onclick="alert('–§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏')">
        üíß –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å–æ—Å–æ–≤
      </button>
      <button class="btn-warning" onclick="alert('–§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏')">
        üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–∫–∞—á–∫–∏
      </button>
      <button class="btn-secondary" onclick="alert('–§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏')">
        ‚ö° –≠–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ
      </button>
    </div>
  </div>
</div>

<!-- –≠–ö–†–ê–ù 12: –°–õ–£–ñ–ë–ê –°–ï–¢–ï–ô -->
<div id="networks-screen" class="screen">
  <div class="category-header">
    <h2>üîå –°–ª—É–∂–±–∞ —Å–µ—Ç–µ–π</h2>
    <button class="btn-secondary" onclick="ScreenManager.show('workspace-screen')">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</button>
  </div>

  <div class="card">
    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã–º–∏ —Å–ª—É–∂–±–∞–º–∏</h3>
    <p>üöß –†–∞–∑–¥–µ–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ - –∑–¥–µ—Å—å –±—É–¥–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º</p>
    
    <div style="display: flex; gap: 10px; margin-top: 20px;">
      <button class="btn-success" onclick="alert('–§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏')">
        üîå –£—á–µ—Ç —Å–µ—Ç–µ–≤–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
      </button>
      <button class="btn-warning" onclick="alert('–§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏')">
        ‚ö° –ê–≤–∞—Ä–∏–π–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
      </button>
      <button class="btn-secondary" onclick="alert('–§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏')">
        üì° –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–≤—è–∑–∏
      </button>
    </div>
  </div>
</div>

<!-- –≠–ö–†–ê–ù 13: –§–û–†–ú–ê –î–û–ë–ê–í–õ–ï–ù–ò–Ø –û–ë–û–†–£–î–û–í–ê–ù–ò–Ø -->
<div id="add-equipment-screen" class="screen">
  <div class="category-header">
    <h2>‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ç–µ—Ö–Ω–∏–∫–∏ –≠–ö–ì</h2>
    <button class="btn-secondary" onclick="ScreenManager.show('ekg-screen')">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É —ç–∫—Å–∫–∞–≤–∞—Ç–æ—Ä–æ–≤</button>
  </div>

  <div style="display: flex; gap: 20px;">
    <!-- –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨ - –ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã -->
    <div style="flex: 0 0 250px;">
      <div class="card">
        <h4>üìÅ –ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã</h4>
        <div style="display: flex; flex-direction: column; gap: 10px;">
          <button class="equipment-btn" style="width: 100%; text-align: left;" onclick="addPhoto()">
            üì∑ –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ
          </button>
          <button class="equipment-btn" style="width: 100%; text-align: left;" onclick="addElectricalSchemes()">
            üìÑ –≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Å—Ö–µ–º—ã (PDF)
          </button>
          <button class="equipment-btn" style="width: 100%; text-align: left;" onclick="addCabinetPhotos()">
            üñºÔ∏è –§–æ—Ç–æ —à–∫–∞—Ñ–æ–≤ –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
          </button>
        </div>
        
        <!-- –ü—Ä–µ–≤—å—é –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ -->
        <div id="file-previews" style="margin-top: 15px;">
          <div class="note">–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</div>
        </div>
      </div>
    </div>

    <!-- –û–°–ù–û–í–ù–û–ô –ë–õ–û–ö - –§–æ—Ä–º–∞ –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö -->
    <div style="flex: 1;">
      <div class="card">
        <h3>üìã –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —ç–∫—Å–∫–∞–≤–∞—Ç–æ—Ä–∞</h3>
        
        <div style="display: flex; gap: 20px;">
          <!-- –ü–ï–†–í–´–ô –°–¢–û–õ–ë–ï–¶ -->
          <div style="flex: 1;">
            <!-- –ü–æ–ª–Ω–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏ -->
            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 5px; font-weight: bold;">üè∑Ô∏è –ü–æ–ª–Ω–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏</label>
              <input type="text" id="equipment-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –≠–ö–ì-5–ê" style="width: 100%;">
            </div>

            <!-- –í—ã–±–æ—Ä –ª–æ–ø–∞—Ç—ã -->
            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 5px; font-weight: bold;">‚õèÔ∏è –í—ã–±–æ—Ä –ª–æ–ø–∞—Ç—ã</label>
              <select id="shovel-type" style="width: 100%;">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ª–æ–ø–∞—Ç—ã</option>
                <option value="–ø—Ä—è–º–∞—è">–ü—Ä—è–º–∞—è –ª–æ–ø–∞—Ç–∞</option>
                <option value="–æ–±—Ä–∞—Ç–Ω–∞—è">–û–±—Ä–∞—Ç–Ω–∞—è –ª–æ–ø–∞—Ç–∞</option>
              </select>
            </div>

            <!-- –¢–∏–ø –ø—Ä–∏–≤–æ–¥–∞ -->
            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 5px; font-weight: bold;">üîß –í—ã–±–æ—Ä –ø—Ä–∏–≤–æ–¥–∞</label>
              <select id="drive-type" style="width: 100%;">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø—Ä–∏–≤–æ–¥–∞</option>
                <option value="—Ä–µ–µ—á–Ω—ã–π">–†–µ–µ—á–Ω—ã–π</option>
                <option value="–∫–∞–Ω–∞—Ç–Ω—ã–π">–ö–∞–Ω–∞—Ç–Ω—ã–π</option>
              </select>
            </div>

            <!-- –ü–æ—Ç—Ä–µ–±–ª—è–µ–º–∞—è –º–æ—â–Ω–æ—Å—Ç—å -->
            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 5px; font-weight: bold;">‚ö° –ü–æ—Ç—Ä–µ–±–ª—è–µ–º–∞—è –º–æ—â–Ω–æ—Å—Ç—å (–í—Ç)</label>
              <input type="number" id="power-consumption" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 1500000" style="width: 100%;">
            </div>

            <!-- –ú–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è –ø–æ–¥—ä–µ–º–∞ -->
            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 5px; font-weight: bold;">üîº –ü–æ–¥—ä–µ–º –º–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è (–∫–í—Ç)</label>
              <input type="number" id="lift-power" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 250" style="width: 100%;">
            </div>

            <!-- –ú–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è –Ω–∞–ø–æ—Ä–∞ -->
            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 5px; font-weight: bold;">üìè –ù–∞–ø–æ—Ä –º–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è (–∫–í—Ç)</label>
              <input type="number" id="pressure-power" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 200" style="width: 100%;">
            </div>

            <!-- –†–µ–º–æ–Ω—Ç –ï–¢–û -->
            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 5px; font-weight: bold;">üîß –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–º–æ–Ω—Ç –ï–¢–û</label>
              <textarea id="eto-repair" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–º–æ–Ω—Ç–∞ –ï–¢–û..." rows="3" style="width: 100%;"></textarea>
            </div>
          </div>

          <!-- –í–¢–û–†–û–ô –°–¢–û–õ–ë–ï–¶ -->
          <div style="flex: 1;">
            <!-- –ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä -->
            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 5px; font-weight: bold;">üî¢ –ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä</label>
              <input type="text" id="serial-number" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 001-2024" style="width: 100%;">
            </div>

            <!-- –í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∫–æ–≤—à–∞ -->
            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 5px; font-weight: bold;">ü™£ –í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∫–æ–≤—à–∞ (–º¬≥)</label>
              <input type="number" step="0.1" id="bucket-capacity" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5.0" style="width: 100%;">
            </div>

            <!-- –î–∞—Ç–∞ –≤–≤–æ–¥–∞ –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é -->
            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 5px; font-weight: bold;">üìÖ –î–∞—Ç–∞ –≤–≤–æ–¥–∞ –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é</label>
              <input type="date" id="commissioning-date" style="width: 100%;">
            </div>

            <!-- –ú–æ—â–Ω–æ—Å—Ç—å –¢–°–ù -->
            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 5px; font-weight: bold;">üíß –ú–æ—â–Ω–æ—Å—Ç—å –¢–°–ù (–∫–í—Ç)</label>
              <input type="number" id="tsn-power" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 15" style="width: 100%;">
            </div>

            <!-- –ú–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è –ø–æ–≤–æ—Ä–æ—Ç–∞ -->
            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 5px; font-weight: bold;">üîÑ –ü–æ–≤–æ—Ä–æ—Ç –º–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è (–∫–í—Ç)</label>
              <input type="number" id="rotation-power" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 180" style="width: 100%;">
            </div>

            <!-- –ú–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è —Ö–æ–¥–∞ -->
            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 5px; font-weight: bold;">üö∂ –•–æ–¥ –º–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è (–∫–í—Ç)</label>
              <input type="number" id="travel-power" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 220" style="width: 100%;">
            </div>

            <!-- –†–µ–º–æ–Ω—Ç –¢–†1 -->
            <div style="margin-bottom: 15px;">
              <label style="display: block; margin-bottom: 5px; font-weight: bold;">üîß –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–º–æ–Ω—Ç –¢–†1</label>
              <textarea id="tr1-repair" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–º–æ–Ω—Ç–∞ –¢–†1..." rows="3" style="width: 100%;"></textarea>
            </div>
          </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è -->
        <div style="display: flex; gap: 10px; margin-top: 20px;">
          <button class="btn-success" onclick="saveEquipment()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ—Ö–Ω–∏–∫—É</button>
          <button class="btn-secondary" onclick="clearForm()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É</button>
          <button class="btn-warning" onclick="saveAsDraft()">üìù –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫</button>
        </div>
      </div>

      <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è -->
      <div class="card" style="margin-top: 20px;">
        <h3>üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ—Ö–Ω–∏–∫–∏</h3>
        <div id="equipment-preview">
          <div class="note">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞</div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// ==================== –°–ò–°–¢–ï–ú–ê –•–†–ê–ù–ï–ù–ò–Ø ====================
class CMMSStorage {
    static getUsers() {
        const storedUsers = JSON.parse(localStorage.getItem('cmms_users'));
        if (!storedUsers) {
            const defaultUsers = {
                'admin': { 
                    password: 'admin123', 
                    role: 'admin', 
                    firstLogin: false,
                    fullName: '–ì–ª–∞–≤–Ω—ã–π –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'
                },
                'engineer': { 
                    password: 'engineer123', 
                    role: 'engineer', 
                    firstLogin: true,
                    fullName: '–°–µ—Ä–≥–µ–π –ü–µ—Ç—Ä–æ–≤'
                }
            };
            this.saveUsers(defaultUsers);
            return defaultUsers;
        }
        return storedUsers;
    }

    static saveUsers(users) {
        localStorage.setItem('cmms_users', JSON.stringify(users));
    }

    static getTrainingData() {
        return JSON.parse(localStorage.getItem('cmms_training')) || {
            material: '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É CMMS. –≠—Ç–æ –±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã...',
            questions: []
        };
    }

    static saveTrainingData(data) {
        localStorage.setItem('cmms_training', JSON.stringify(data));
    }

    static getTestResults() {
        return JSON.parse(localStorage.getItem('cmms_results')) || [];
    }

    static saveTestResult(result) {
        const results = this.getTestResults();
        results.push({...result, source: 'local'});
        localStorage.setItem('cmms_results', JSON.stringify(results));
    }

    static getEquipment() {
        return JSON.parse(localStorage.getItem('cmms_equipment') || '[]');
    }

    static saveEquipment(equipment) {
        localStorage.setItem('cmms_equipment', JSON.stringify(equipment));
    }
}

// ==================== –£–ü–†–ê–í–õ–ï–ù–ò–ï –≠–ö–†–ê–ù–ê–ú–ò ====================
class ScreenManager {
    static show(screenId) {
        document.querySelectorAll('.screen').forEach(screen => {
            screen.classList.remove('active');
        });
        document.getElementById(screenId).classList.add('active');
    }
}

// ==================== –§–£–ù–ö–¶–ò–ò –û–ë–û–†–£–î–û–í–ê–ù–ò–Ø ====================
function openEquipmentCategory(category) {
    const screenMap = {
        '–≠–ö–ì': 'ekg-screen',
        '–ë–µ–ª–ê–∑—ã': 'belaz-screen', 
        '–ë—É—Ä–æ–≤—ã–µ': 'drilling-screen',
        '–í–æ–¥–æ–æ—Ç–ª–∏–≤': 'drainage-screen',
        '–°–µ—Ç–∏': 'networks-screen'
    };
    
    const screenId = screenMap[category];
    if (screenId) {
        ScreenManager.show(screenId);
    }
}

// ==================== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –≠–ö–†–ê–ù–ê –≠–ö–ì ====================
let selectedEquipmentId = 1;

function selectEquipment(id) {
    selectedEquipmentId = id;
    
    // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —É –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    document.querySelectorAll('.equipment-item').forEach(item => {
        item.classList.remove('selected');
    });
    
    // –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É
    const selectedItem = document.querySelector(`.equipment-item[data-id="${id}"]`);
    if (selectedItem) {
        selectedItem.classList.add('selected');
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —à–∞–ø–∫—É —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º
    if (selectedItem) {
        const equipmentName = selectedItem.textContent;
        const selectElement = document.getElementById('current-excavator');
        if (selectElement) {
            selectElement.value = equipmentName.split('. ')[1];
        }
    }
    
    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
    loadEquipmentData(id);
}

function loadEquipmentData(equipmentId) {
    // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (–∑–∞–≥–ª—É—à–∫–∞)
    console.log(`–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è ID: ${equipmentId}`);
}

function acceptShift() {
    alert('–§—É–Ω–∫—Ü–∏—è "–ü—Ä–∏–Ω—è—Ç—å —Å–º–µ–Ω—É" –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞');
}

function handOverShift() {
    alert('–§—É–Ω–∫—Ü–∏—è "–°–¥–∞—Ç—å —Å–º–µ–Ω—É" –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞');
}

function registerMalfunction() {
    alert('–§—É–Ω–∫—Ü–∏—è "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π" –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞');
}

function viewMalfunctions() {
    alert('–§—É–Ω–∫—Ü–∏—è "–ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π" –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞');
}

function resolveMalfunctions() {
    alert('–§—É–Ω–∫—Ü–∏—è "–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π" –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞');
}

function addNewRecord() {
    alert('–§—É–Ω–∫—Ü–∏—è "–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å" –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞');
}

function exportShiftReport() {
    alert('–§—É–Ω–∫—Ü–∏—è "–≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–∞ —Å–º–µ–Ω—ã" –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞');
}

// ==================== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –§–û–†–ú–´ –î–û–ë–ê–í–õ–ï–ù–ò–Ø –¢–ï–•–ù–ò–ö–ò ====================

function showAddEquipmentForm() {
    ScreenManager.show('add-equipment-screen');
    clearForm();
}

function addPhoto() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'image/*';
    input.multiple = true;
    input.onchange = function(e) {
        handleFileUpload(e.target.files, 'photo');
    };
    input.click();
}

function addElectricalSchemes() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.pdf';
    input.multiple = true;
    input.onchange = function(e) {
        handleFileUpload(e.target.files, 'scheme');
    };
    input.click();
}

function addCabinetPhotos() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'image/*';
    input.multiple = true;
    input.onchange = function(e) {
        handleFileUpload(e.target.files, 'cabinet');
    };
    input.click();
}

function handleFileUpload(files, type) {
    const previews = document.getElementById('file-previews');
    const typeLabels = {
        'photo': 'üì∑ –§–æ—Ç–æ',
        'scheme': 'üìÑ –°—Ö–µ–º–∞',
        'cabinet': 'üñºÔ∏è –®–∫–∞—Ñ'
    };
    
    Array.from(files).forEach(file => {
        const fileDiv = document.createElement('div');
        fileDiv.className = 'equipment-item';
        fileDiv.style.display = 'flex';
        fileDiv.style.justifyContent = 'space-between';
        fileDiv.style.alignItems = 'center';
        fileDiv.style.padding = '8px';
        
        fileDiv.innerHTML = `
            <div>
                <strong>${typeLabels[type]}</strong><br>
                <small>${file.name}</small>
            </div>
            <button class="btn-danger" style="padding: 4px 8px; font-size: 12px;" 
                    onclick="this.parentElement.remove()">√ó</button>
        `;
        
        previews.appendChild(fileDiv);
    });
    
    // –£–±–∏—Ä–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å"
    const note = previews.querySelector('.note');
    if (note) note.remove();
}

function updatePreview() {
    const preview = document.getElementById('equipment-preview');
    const name = document.getElementById('equipment-name').value;
    const serial = document.getElementById('serial-number').value;
    
    if (!name && !serial) {
        preview.innerHTML = '<div class="note">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞</div>';
        return;
    }
    
    preview.innerHTML = `
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <div>
                <strong>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong>
                <div>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ: ${name || '–Ω–µ —É–∫–∞–∑–∞–Ω–æ'}</div>
                <div>–ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä: ${serial || '–Ω–µ —É–∫–∞–∑–∞–Ω'}</div>
                <div>–¢–∏–ø –ª–æ–ø–∞—Ç—ã: ${document.getElementById('shovel-type').value || '–Ω–µ –≤—ã–±—Ä–∞–Ω'}</div>
                <div>–¢–∏–ø –ø—Ä–∏–≤–æ–¥–∞: ${document.getElementById('drive-type').value || '–Ω–µ –≤—ã–±—Ä–∞–Ω'}</div>
            </div>
            <div>
                <strong>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:</strong>
                <div>–ú–æ—â–Ω–æ—Å—Ç—å: ${document.getElementById('power-consumption').value || '0'} –í—Ç</div>
                <div>–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∫–æ–≤—à–∞: ${document.getElementById('bucket-capacity').value || '0'} –º¬≥</div>
                <div>–î–∞—Ç–∞ –≤–≤–æ–¥–∞: ${document.getElementById('commissioning-date').value || '–Ω–µ —É–∫–∞–∑–∞–Ω–∞'}</div>
            </div>
        </div>
    `;
}

function saveEquipment() {
    const equipmentData = collectEquipmentData();
    
    if (!validateEquipmentData(equipmentData)) {
        return;
    }
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
    const existingEquipment = CMMSStorage.getEquipment();
    equipmentData.id = Date.now();
    equipmentData.createdAt = new Date().toISOString();
    existingEquipment.push(equipmentData);
    CMMSStorage.saveEquipment(existingEquipment);
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Ö–Ω–∏–∫—É –≤ —Å–ø–∏—Å–æ–∫ –Ω–∞ —ç–∫—Ä–∞–Ω–µ –≠–ö–ì
    addEquipmentToList(equipmentData);
    
    alert('‚úÖ –¢–µ—Ö–Ω–∏–∫–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!');
    ScreenManager.show('ekg-screen');
}

function addEquipmentToList(equipmentData) {
    const equipmentList = document.getElementById('equipment-list');
    if (!equipmentList) return;
    
    const newId = equipmentList.children.length + 1;
    
    const newItem = document.createElement('div');
    newItem.className = 'equipment-item';
    newItem.setAttribute('data-id', newId);
    newItem.textContent = `${newId}. ${equipmentData.name}`;
    newItem.onclick = function() { selectEquipment(newId); };
    
    equipmentList.appendChild(newItem);
    
    // –î–æ–±–∞–≤–ª—è–µ–º –≤ –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –≤ —à–∞–ø–∫–µ
    const select = document.getElementById('current-excavator');
    if (select) {
        const option = document.createElement('option');
        option.value = equipmentData.name;
        option.textContent = equipmentData.name;
        select.appendChild(option);
    }
}

function saveAsDraft() {
    const equipmentData = collectEquipmentData();
    equipmentData.id = Date.now();
    equipmentData.isDraft = true;
    equipmentData.createdAt = new Date().toISOString();
    
    const drafts = JSON.parse(localStorage.getItem('cmms_equipment_drafts') || '[]');
    drafts.push(equipmentData);
    localStorage.setItem('cmms_equipment_drafts', JSON.stringify(drafts));
    
    alert('üìù –ß–µ—Ä–Ω–æ–≤–∏–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
}

function collectEquipmentData() {
    return {
        name: document.getElementById('equipment-name').value,
        shovelType: document.getElementById('shovel-type').value,
        driveType: document.getElementById('drive-type').value,
        powerConsumption: document.getElementById('power-consumption').value,
        liftPower: document.getElementById('lift-power').value,
        pressurePower: document.getElementById('pressure-power').value,
        etoRepair: document.getElementById('eto-repair').value,
        serialNumber: document.getElementById('serial-number').value,
        bucketCapacity: document.getElementById('bucket-capacity').value,
        commissioningDate: document.getElementById('commissioning-date').value,
        tsnPower: document.getElementById('tsn-power').value,
        rotationPower: document.getElementById('rotation-power').value,
        travelPower: document.getElementById('travel-power').value,
        tr1Repair: document.getElementById('tr1-repair').value
    };
}

function validateEquipmentData(data) {
    if (!data.name) {
        alert('‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏');
        return false;
    }
    if (!data.serialNumber) {
        alert('‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä');
        return false;
    }
    return true;
}

function clearForm() {
    document.getElementById('equipment-name').value = '';
    document.getElementById('shovel-type').value = '';
    document.getElementById('drive-type').value = '';
    document.getElementById('power-consumption').value = '';
    document.getElementById('lift-power').value = '';
    document.getElementById('pressure-power').value = '';
    document.getElementById('eto-repair').value = '';
    document.getElementById('serial-number').value = '';
    document.getElementById('bucket-capacity').value = '';
    document.getElementById('commissioning-date').value = '';
    document.getElementById('tsn-power').value = '';
    document.getElementById('rotation-power').value = '';
    document.getElementById('travel-power').value = '';
    document.getElementById('tr1-repair').value = '';
    
    document.getElementById('file-previews').innerHTML = '<div class="note">–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</div>';
    document.getElementById('equipment-preview').innerHTML = '<div class="note">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞</div>';
}

// ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
let currentUser = null;
let currentTest = {
    questions: [],
    currentQuestionIndex: 0,
    userAnswers: []
};

// ==================== –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –í–•–û–î–ê ====================
async function handleLogin() {
    const login = document.getElementById('login').value.trim();
    const password = document.getElementById('password').value.trim();

    if (!login || !password) {
        document.getElementById('login-msg').textContent = '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è';
        return;
    }

    const loginBtn = document.getElementById('login-btn');
    loginBtn.classList.add('loading');
    loginBtn.textContent = '–í—Ö–æ–¥...';

    try {
        const users = CMMSStorage.getUsers();
        
        if (!users[login] || users[login].password !== password) {
            document.getElementById('login-msg').textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å';
            return;
        }

        currentUser = { 
            login, 
            ...users[login],
            id: login
        };
        handleSuccessfulLogin();

    } catch (error) {
        console.error('Login error:', error);
        document.getElementById('login-msg').textContent = '–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ';
    } finally {
        loginBtn.classList.remove('loading');
        loginBtn.textContent = '–í–æ–π—Ç–∏';
    }
}

function handleSuccessfulLogin() {
    if (currentUser.role === 'admin') {
        ScreenManager.show('admin-dashboard-screen');
    } else {
        if (currentUser.firstLogin) {
            loadStudyMaterials();
            ScreenManager.show('study-screen');
        } else {
            showWorkspace();
        }
    }
}

// ==================== –ë–ê–ó–û–í–´–ï –§–£–ù–ö–¶–ò–ò ====================
function showUserManagement() {
    alert('–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ');
}

function showSystemSettings() {
    alert('–°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—É–¥—É—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã');
}

function generateReport() {
    alert('–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞');
}

function generateUserReport() {
    alert('–§—É–Ω–∫—Ü–∏—è "–ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞');
}

// ==================== –°–ò–°–¢–ï–ú–ê –û–ë–£–ß–ï–ù–ò–Ø ====================
function loadStudyMaterials() {
    const trainingData = CMMSStorage.getTrainingData();
    document.getElementById('study-content').innerHTML = `
        <div style="white-space: pre-wrap; line-height: 1.5;">${trainingData.material}</div>
    `;
}

function startEmployeeTest() {
    const trainingData = CMMSStorage.getTrainingData();
    
    if (trainingData.questions.length === 0) {
        alert('–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –µ—â–µ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–∏–ª –≤–æ–ø—Ä–æ—Å—ã —Ç–µ—Å—Ç–∞');
        return;
    }

    currentTest = {
        questions: trainingData.questions,
        currentQuestionIndex: 0,
        userAnswers: []
    };

    ScreenManager.show('test-screen');
    showCurrentQuestion();
}

function showCurrentQuestion() {
    const question = currentTest.questions[currentTest.currentQuestionIndex];
    document.getElementById('question-text').textContent = question.text;
    document.getElementById('test-progress').textContent = 
        `–í–æ–ø—Ä–æ—Å ${currentTest.currentQuestionIndex + 1} –∏–∑ ${currentTest.questions.length}`;
    document.getElementById('answer-input').value = '';
}

function handleNextQuestion() {
    const answer = document.getElementById('answer-input').value.trim();
    
    if (!answer) {
        document.getElementById('test-msg').textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç';
        return;
    }

    currentTest.userAnswers.push(answer);
    currentTest.currentQuestionIndex++;
    
    if (currentTest.currentQuestionIndex < currentTest.questions.length) {
        showCurrentQuestion();
    } else {
        completeTest();
    }
}

async function completeTest() {
    const users = CMMSStorage.getUsers();
    
    users[currentUser.login].firstLogin = false;
    CMMSStorage.saveUsers(users);
    
    const trainingData = CMMSStorage.getTrainingData();
    let correctAnswers = 0;
    
    currentTest.userAnswers.forEach((answer, index) => {
        if (answer.toLowerCase() === trainingData.questions[index].correctAnswer.toLowerCase()) {
            correctAnswers++;
        }
    });

    const testResult = {
        user: currentUser.login,
        date: new Date().toLocaleDateString('ru-RU'),
        score: `${correctAnswers}/${trainingData.questions.length}`,
        status: correctAnswers >= trainingData.questions.length * 0.7 ? '–°–¥–∞–Ω' : '–ù–µ —Å–¥–∞–Ω'
    };

    CMMSStorage.saveTestResult(testResult);
    showWorkspace();
}

async function showWorkspace() {
    document.getElementById('current-user-role').textContent = 
        currentUser.role === 'admin' ? 'üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' : '‚öôÔ∏è –ò–Ω–∂–µ–Ω–µ—Ä';
    
    const adminFeatures = document.getElementById('admin-workspace-features');
    const userFeatures = document.getElementById('user-workspace-features');
    
    if (currentUser.role === 'admin') {
        adminFeatures.style.display = 'block';
        userFeatures.style.display = 'none';
    } else {
        adminFeatures.style.display = 'none';
        userFeatures.style.display = 'block';
    }
    
    ScreenManager.show('workspace-screen');
}

async function showResults() {
    ScreenManager.show('results-screen');
    
    const results = CMMSStorage.getTestResults();
    updateResultsUI(results);
}

function updateResultsUI(results) {
    const tbody = document.getElementById('results-body');
    
    tbody.innerHTML = results.map(result => `
        <tr>
            <td>${result.user}</td>
            <td>${result.date}</td>
            <td>${result.score}</td>
            <td>${result.status}</td>
        </tr>
    `).join('');
}

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
function loadQuestions() {
    const questionsContainer = document.getElementById('questions-container');
    const trainingData = CMMSStorage.getTrainingData();
    
    questionsContainer.innerHTML = '';
    trainingData.questions.forEach((question, index) => {
        addQuestionToUI(question, index);
    });
}

function addNewQuestion() {
    const trainingData = CMMSStorage.getTrainingData();
    if (trainingData.questions.length >= 10) {
        alert('–ú–∞–∫—Å–∏–º—É–º 10 –≤–æ–ø—Ä–æ—Å–æ–≤');
        return;
    }
    
    const newQuestion = { text: '', correctAnswer: '' };
    trainingData.questions.push(newQuestion);
    addQuestionToUI(newQuestion, trainingData.questions.length - 1);
}

function addQuestionToUI(question, index) {
    const questionsContainer = document.getElementById('questions-container');
    const questionDiv = document.createElement('div');
    questionDiv.className = 'question-item';
    questionDiv.innerHTML = `
        <strong>–í–æ–ø—Ä–æ—Å ${index + 1}:</strong>
        <input type="text" class="question-text" data-index="${index}" 
               placeholder="–¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞" value="${question.text}">
        <input type="text" class="question-answer" data-index="${index}" 
               placeholder="–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç" value="${question.correctAnswer}">
        <button class="btn-danger remove-question" data-index="${index}">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
    `;
    questionsContainer.appendChild(questionDiv);

    questionDiv.querySelector('.remove-question').addEventListener('click', function() {
        const index = parseInt(this.getAttribute('data-index'));
        const trainingData = CMMSStorage.getTrainingData();
        trainingData.questions.splice(index, 1);
        loadQuestions();
    });
}

async function saveTrainingData() {
    const trainingData = {
        material: document.getElementById('training-material').value,
        questions: []
    };

    document.querySelectorAll('.question-text').forEach(input => {
        const index = parseInt(input.getAttribute('data-index'));
        if (!trainingData.questions[index]) trainingData.questions[index] = {};
        trainingData.questions[index].text = input.value;
    });

    document.querySelectorAll('.question-answer').forEach(input => {
        const index = parseInt(input.getAttribute('data-index'));
        if (!trainingData.questions[index]) trainingData.questions[index] = {};
        trainingData.questions[index].correctAnswer = input.value;
    });

    CMMSStorage.saveTrainingData(trainingData);
    alert('‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ!');
}

function logout() {
    currentUser = null;
    ScreenManager.show('login-screen');
    document.getElementById('login').value = '';
    document.getElementById('password').value = '';
    document.getElementById('login-msg').textContent = '';
}

// ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
function initializeLoginSystem() {
    document.getElementById('login-btn').addEventListener('click', handleLogin);
    document.getElementById('logout-admin').addEventListener('click', logout);
    document.getElementById('logout-study').addEventListener('click', logout);
    document.getElementById('logout-workspace').addEventListener('click', logout);
    document.getElementById('start-test-btn').addEventListener('click', startEmployeeTest);
    document.getElementById('next-question-btn').addEventListener('click', handleNextQuestion);
    document.getElementById('admin-setup-btn').addEventListener('click', () => ScreenManager.show('admin-setup-screen'));
    document.getElementById('admin-workspace-btn').addEventListener('click', showWorkspace);
    document.getElementById('view-results-btn').addEventListener('click', showResults);
    document.getElementById('back-to-admin-dashboard').addEventListener('click', () => ScreenManager.show('admin-dashboard-screen'));
    document.getElementById('back-to-admin-from-results').addEventListener('click', () => ScreenManager.show('admin-dashboard-screen'));
    document.getElementById('manage-users-btn').addEventListener('click', showUserManagement);
    document.getElementById('system-status-btn').addEventListener('click', showSystemSettings);
    document.getElementById('add-question-btn').addEventListener('click', addNewQuestion);
    document.getElementById('save-training-btn').addEventListener('click', saveTrainingData);

    loadQuestions();
}

document.addEventListener('DOMContentLoaded', function() {
    initializeLoginSystem();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–∫—Ä–∞–Ω–∞ –≠–ö–ì –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    if (document.querySelector('.equipment-item')) {
        selectEquipment(1);
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è —Ñ–æ—Ä–º—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
    const formScreen = document.getElementById('add-equipment-screen');
    if (formScreen) {
        const inputs = formScreen.querySelectorAll('input, select, textarea');
        inputs.forEach(input => {
            input.addEventListener('input', updatePreview);
            input.addEventListener('change', updatePreview);
        });
    }
});
</script>
</body>
</html>

