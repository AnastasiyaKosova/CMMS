<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CMMS ‚Äî –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ–º</title>
<style>
  body {margin:0; font-family: Inter, sans-serif; background: #0f1724; color: #e6eef6; display:flex; justify-content:center; align-items:flex-start; padding-top:20px;}
  .screen {display:none; padding:20px; border-radius:12px; background: #0b1220; width:95%; max-width:1200px; box-shadow:0 6px 18px rgba(2,6,23,0.6);}
  .active {display:block;}
  
  .admin-panel { background: #1e293b; border-left: 4px solid #06b6d4; }
  .question-item { background: rgba(255,255,255,0.03); padding: 12px; margin: 8px 0; border-radius: 8px; }
  .results-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
  .results-table th { background: rgba(6,182,212,0.1); padding: 10px; text-align: left; }
  .results-table td { padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); }
  
  input, textarea, select {width:100%; padding:8px; margin-bottom:12px; border-radius:8px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:#e6eef6;}
  button {padding:10px 16px; border:none; border-radius:10px; background:#06b6d4; color:#052026; cursor:pointer; margin:4px;}
  .btn-danger {background:#ef4444;}
  .btn-success {background:#10b981;}
  .btn-secondary {background:#64748b;}
  .btn-warning {background:#f59e0b;}
  .note {font-size:12px; color:#94a3b8; margin-bottom:12px;}
  .card {background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.04)); border-radius:12px; padding:14px; box-shadow:0 6px 18px rgba(2,6,23,0.6); margin-bottom:12px;}
  
  .admin-dashboard { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
  .admin-card { background: rgba(255,255,255,0.03); padding: 20px; border-radius: 12px; text-align: center; }
  .admin-card h3 { margin-top: 0; }
  
  .equipment-stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin: 15px 0; }
  .equipment-stats div { padding: 15px; background: rgba(255,255,255,0.03); border-radius: 8px; text-align: center; }
  .stat-value { font-size: 24px; font-weight: bold; margin: 5px 0; }
  
  .status-operational { color: #10b981; }
  .status-maintenance { color: #f59e0b; }
  .status-failed { color: #ef4444; }
  .status-pending { color: #8b5cf6; }
  .status-standby { color: #64748b; }
  
  .api-status { position: fixed; top: 10px; right: 10px; padding: 5px 10px; border-radius: 5px; font-size: 12px; }
  .api-online { background: #10b981; color: white; }
  .api-offline { background: #ef4444; color: white; }
  
  .workspace-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
  .workspace-section { min-height: 300px; }
  
  .equipment-card { background: rgba(255,255,255,0.02); border-radius: 10px; padding: 15px; margin-bottom: 10px; border-left: 4px solid; }
  .equipment-card.operational { border-left-color: #10b981; }
  .equipment-card.maintenance { border-left-color: #f59e0b; }
  .equipment-card.failed { border-left-color: #ef4444; }
  .equipment-card.standby { border-left-color: #64748b; }
  
  .equipment-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
  .equipment-name { font-weight: bold; font-size: 16px; }
  .equipment-status { padding: 4px 8px; border-radius: 6px; font-size: 12px; background: rgba(255,255,255,0.1); }
  
  .metrics-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-top: 10px; }
  .metric { text-align: center; padding: 5px; background: rgba(255,255,255,0.03); border-radius: 5px; }
  .metric-value { font-weight: bold; font-size: 14px; }
  .metric-label { font-size: 10px; color: #94a3b8; }
  
  .action-buttons { display: flex; gap: 5px; margin-top: 10px; }
  .action-btn { padding: 6px 10px; font-size: 11px; }
  
  .tab-container { margin: 20px 0; }
  .tab-buttons { display: flex; gap: 5px; margin-bottom: 15px; }
  .tab-btn { padding: 8px 16px; background: rgba(255,255,255,0.05); border: none; border-radius: 6px; color: #e6eef6; cursor: pointer; }
  .tab-btn.active { background: #06b6d4; color: #052026; }
  .tab-content { display: none; }
  .tab-content.active { display: block; }
  
  .alert-banner { background: #ef4444; color: white; padding: 10px; border-radius: 6px; margin: 10px 0; display: flex; justify-content: space-between; align-items: center; }
  .alert-banner.warning { background: #f59e0b; }
  
  .maintenance-schedule { margin-top: 15px; }
  .schedule-item { padding: 10px; background: rgba(255,255,255,0.03); border-radius: 6px; margin-bottom: 8px; }
  
  .loading { opacity: 0.6; pointer-events: none; }
  .skeleton { background: linear-gradient(90deg, rgba(255,255,255,0.05) 25%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.05) 75%); background-size: 200% 100%; animation: loading 1.5s infinite; }
  @keyframes loading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
</style>
</head>
<body>

<div id="api-status" class="api-status api-offline">API: –û—Ñ—Ñ–ª–∞–π–Ω</div>

<!-- –≠–∫—Ä–∞–Ω 1: –í—Ö–æ–¥ -->
<div id="login-screen" class="screen active">
  <h2>–í—Ö–æ–¥ –≤ CMMS</h2>
  <input id="login" type="text" placeholder="–õ–æ–≥–∏–Ω">
  <input id="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
  <button id="login-btn">–í–æ–π—Ç–∏</button>
  <div id="login-msg" class="note"></div>
  <div class="note">
    <strong>–¢–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:</strong><br>
    üëë –ê–¥–º–∏–Ω: admin / admin123<br>
    ‚öôÔ∏è –ò–Ω–∂–µ–Ω–µ—Ä: engineer / engineer123
  </div>
</div>

<!-- –≠–∫—Ä–∞–Ω 2: –ê–¥–º–∏–Ω –î–∞—à–±–æ—Ä–¥ -->
<div id="admin-dashboard-screen" class="screen admin-panel">
  <h2>üëë –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
  
  <div class="admin-dashboard">
    <div class="admin-card">
      <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—É—á–µ–Ω–∏—è</h3>
      <p>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</p>
      <button id="admin-setup-btn">–ü–µ—Ä–µ–π—Ç–∏ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º</button>
    </div>
    
    <div class="admin-card">
      <h3>üõ†Ô∏è –†–∞–±–æ—á–µ–µ –æ–∫–Ω–æ</h3>
      <p>–î–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º —Å–∏—Å—Ç–µ–º—ã</p>
      <button id="admin-workspace-btn">–ü–µ—Ä–µ–π—Ç–∏ –≤ —Ä–∞–±–æ—á–µ–µ –æ–∫–Ω–æ</button>
    </div>
  </div>

  <div class="card">
    <h3>üìä –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø</h3>
    <button id="view-results-btn">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤</button>
    <button id="manage-users-btn">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</button>
    <button id="system-status-btn">–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</button>
  </div>

  <button class="btn-secondary" id="logout-admin">üö™ –í—ã–π—Ç–∏</button>
</div>

<!-- –≠–∫—Ä–∞–Ω 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ -->
<div id="admin-setup-screen" class="screen admin-panel">
  <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—É—á–∞—é—â–∏—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</h2>
  
  <div class="card">
    <h3>üìö –£—á–µ–±–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª</h3>
    <textarea id="training-material" rows="10" placeholder="–í–≤–µ–¥–∏—Ç–µ —É—á–µ–±–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª (–º–æ–∂–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ Word)...">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É CMMS. –≠—Ç–æ –±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã...</textarea>
  </div>
  
  <div class="card">
    <h3>‚ùì –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (10 –≤–æ–ø—Ä–æ—Å–æ–≤)</h3>
    <div id="questions-container">
      <!-- –í–æ–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
    </div>
    <button id="add-question-btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å</button>
  </div>
  
  <button id="save-training-btn" class="btn-success">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ</button>
  <button class="btn-secondary" id="back-to-admin-dashboard">‚Üê –ù–∞–∑–∞–¥ –≤ –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</button>
</div>

<!-- –≠–∫—Ä–∞–Ω 4: –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
<div id="results-screen" class="screen admin-panel">
  <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</h2>
  <div id="results-loading" class="skeleton" style="height: 200px; display: none;"></div>
  <table class="results-table" id="results-table" style="display: none;">
    <thead>
      <tr>
        <th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
        <th>–î–∞—Ç–∞ —Ç–µ—Å—Ç–∞</th>
        <th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
        <th>–°—Ç–∞—Ç—É—Å</th>
        <th>–ò—Å—Ç–æ—á–Ω–∏–∫</th>
      </tr>
    </thead>
    <tbody id="results-body">
    </tbody>
  </table>
  <button class="btn-secondary" id="back-to-admin-from-results">‚Üê –ù–∞–∑–∞–¥ –≤ –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</button>
</div>

<!-- –≠–∫—Ä–∞–Ω 5: –ò–∑—É—á–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ -->
<div id="study-screen" class="screen">
  <h2>üìñ –û–±—É—á–∞—é—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</h2>
  <div id="study-content" class="card">
    <!-- –ú–∞—Ç–µ—Ä–∏–∞–ª –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∑–¥–µ—Å—å -->
  </div>
  <button id="start-test-btn">üéØ –ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é</button>
  <button class="btn-secondary" id="logout-study">üö™ –í—ã–π—Ç–∏</button>
</div>

<!-- –≠–∫—Ä–∞–Ω 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ -->
<div id="test-screen" class="screen">
  <h2>üß† –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞–Ω–∏–π</h2>
  <div id="test-progress">–í–æ–ø—Ä–æ—Å 1 –∏–∑ 10</div>
  <div class="card">
    <h3 id="question-text">–í–æ–ø—Ä–æ—Å –±—É–¥–µ—Ç –∑–¥–µ—Å—å</h3>
    <input type="text" id="answer-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç...">
  </div>
  <button id="next-question-btn">–î–∞–ª–µ–µ ‚Üí</button>
  <div id="test-msg" class="note"></div>
</div>

<!-- –≠–∫—Ä–∞–Ω 7: –†–ï–ê–õ–¨–ù–û–ï –†–ê–ë–û–ß–ï–ï –û–ö–ù–û -->
<div id="workspace-screen" class="screen">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
    <h2 style="margin: 0;">üõ†Ô∏è –†–∞–±–æ—á–µ–µ –æ–∫–Ω–æ CMMS</h2>
    <div style="display: flex; gap: 10px; align-items: center;">
      <span id="current-user-role"></span>
      <span id="api-status-badge" class="status-failed" style="padding: 4px 8px; border-radius: 6px; font-size: 12px; background: rgba(239,68,68,0.2);">–û—Ç–∫–ª—é—á–µ–Ω</span>
      <button class="btn-secondary" id="logout-workspace">üö™ –í—ã–π—Ç–∏</button>
    </div>
  </div>

  <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è -->
  <div class="card">
    <h3>üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
    <div class="equipment-stats" id="equipment-stats">
      <div>
        <div class="metric-label">–í—Å–µ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</div>
        <div class="stat-value" id="total-equipment">0</div>
      </div>
      <div>
        <div class="metric-label">–í —Ä–∞–±–æ—Ç–µ</div>
        <div class="stat-value status-operational" id="operational-count">0</div>
      </div>
      <div>
        <div class="metric-label">–ù–∞ –¢–û</div>
        <div class="stat-value status-maintenance" id="maintenance-count">0</div>
      </div>
      <div>
        <div class="metric-label">–ù–µ–∏—Å–ø—Ä–∞–≤–Ω–æ</div>
        <div class="stat-value status-failed" id="failed-count">0</div>
      </div>
    </div>
  </div>

  <!-- –ê–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
  <div id="alerts-container"></div>

  <!-- –¢–∞–±—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ -->
  <div class="tab-container">
    <div class="tab-buttons">
      <button class="tab-btn active" onclick="switchTab('equipment-tab')">üè≠ –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</button>
      <button class="tab-btn" onclick="switchTab('maintenance-tab')">üîß –¢–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</button>
      <button class="tab-btn" onclick="switchTab('stops-tab')">‚è∏Ô∏è –û—Å—Ç–∞–Ω–æ–≤–∫–∏</button>
      <button class="tab-btn" onclick="switchTab('reports-tab')">üìà –û—Ç—á–µ—Ç—ã</button>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è -->
    <div id="equipment-tab" class="tab-content active">
      <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
        <h3 style="margin: 0;">–°–ø–∏—Å–æ–∫ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</h3>
        <div>
          <select id="department-filter" onchange="filterEquipment()" style="width: auto; display: inline-block; margin-right: 10px;">
            <option value="">–í—Å–µ —Ü–µ—Ö–∞</option>
            <option value="–¶–µ—Ö ‚Ññ1">–¶–µ—Ö ‚Ññ1</option>
            <option value="–¶–µ—Ö ‚Ññ2">–¶–µ—Ö ‚Ññ2</option>
            <option value="–¶–µ—Ö ‚Ññ3">–¶–µ—Ö ‚Ññ3</option>
          </select>
          <select id="status-filter" onchange="filterEquipment()" style="width: auto; display: inline-block;">
            <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
            <option value="operational">–í —Ä–∞–±–æ—Ç–µ</option>
            <option value="maintenance">–ù–∞ –¢–û</option>
            <option value="failed">–ù–µ–∏—Å–ø—Ä–∞–≤–Ω–æ</option>
            <option value="standby">–†–µ–∑–µ—Ä–≤</option>
          </select>
        </div>
      </div>
      
      <div id="equipment-list">
        <!-- –°–ø–∏—Å–æ–∫ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
      </div>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è -->
    <div id="maintenance-tab" class="tab-content">
      <h3>üìÖ –ì—Ä–∞—Ñ–∏–∫ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è</h3>
      <div class="maintenance-schedule" id="maintenance-schedule">
        <!-- –ì—Ä–∞—Ñ–∏–∫ –¢–û –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
      </div>
      
      <h3 style="margin-top: 20px;">üõ†Ô∏è –ê–∫—Ç–∏–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –ø–æ –¢–û</h3>
      <div id="active-maintenance">
        <!-- –ê–∫—Ç–∏–≤–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –¢–û –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
      </div>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ -->
    <div id="stops-tab" class="tab-content">
      <h3>‚è∏Ô∏è –ò—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞–Ω–æ–≤–æ–∫</h3>
      <table class="results-table">
        <thead>
          <tr>
            <th>–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</th>
            <th>–¢–∏–ø –æ—Å—Ç–∞–Ω–æ–≤–∫–∏</th>
            <th>–ù–∞—á–∞–ª–æ</th>
            <th>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
            <th>–°—Ç–∞—Ç—É—Å</th>
            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
          </tr>
        </thead>
        <tbody id="stops-history">
          <!-- –ò—Å—Ç–æ—Ä–∏—è –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
        </tbody>
      </table>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ –æ—Ç—á–µ—Ç–æ–≤ -->
    <div id="reports-tab" class="tab-content">
      <h3>üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã</h3>
      <div class="workspace-grid">
        <div class="card">
          <h4>üìä –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</h4>
          <div id="utilization-chart" style="height: 200px; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.02); border-radius: 8px;">
            <p>–ì—Ä–∞—Ñ–∏–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –±—É–¥–µ—Ç –∑–¥–µ—Å—å</p>
          </div>
        </div>
        <div class="card">
          <h4>üîß –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¢–û</h4>
          <div id="maintenance-stats" style="height: 200px; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.02); border-radius: 8px;">
            <p>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¢–û –±—É–¥–µ—Ç –∑–¥–µ—Å—å</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ -->
  <div id="admin-workspace-features" style="display: none; margin-top: 20px;">
    <div class="card">
      <h3>üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</h3>
      <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        <button onclick="showUserManagement()">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
        <button onclick="showSystemSettings()">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
        <button onclick="ScreenManager.show('admin-setup-screen')">üìö –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ</button>
        <button onclick="addNewEquipment()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</button>
        <button onclick="generateReport()">üìÑ –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç</button>
      </div>
    </div>
  </div>
</div>

<script>
// ==================== –°–ò–°–¢–ï–ú–ê –•–†–ê–ù–ï–ù–ò–Ø ====================
class CMMSStorage {
    static getUsers() {
        const storedUsers = JSON.parse(localStorage.getItem('cmms_users'));
        if (!storedUsers) {
            const defaultUsers = {
                'admin': { 
                    password: 'admin123', 
                    role: 'admin', 
                    firstLogin: false,
                    fullName: '–ì–ª–∞–≤–Ω—ã–π –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'
                },
                'engineer': { 
                    password: 'engineer123', 
                    role: 'engineer', 
                    firstLogin: true,
                    fullName: '–°–µ—Ä–≥–µ–π –ü–µ—Ç—Ä–æ–≤'
                }
            };
            this.saveUsers(defaultUsers);
            return defaultUsers;
        }
        return storedUsers;
    }

    static saveUsers(users) {
        localStorage.setItem('cmms_users', JSON.stringify(users));
    }

    static getTrainingData() {
        return JSON.parse(localStorage.getItem('cmms_training')) || {
            material: '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É CMMS. –≠—Ç–æ –±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã...',
            questions: []
        };
    }

    static saveTrainingData(data) {
        localStorage.setItem('cmms_training', JSON.stringify(data));
    }

    static getTestResults() {
        return JSON.parse(localStorage.getItem('cmms_results')) || [];
    }

    static saveTestResult(result) {
        const results = this.getTestResults();
        results.push({...result, source: 'local'});
        localStorage.setItem('cmms_results', JSON.stringify(results));
    }
}

// ==================== –†–ï–ê–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï –û–ë–û–†–£–î–û–í–ê–ù–ò–Ø ====================
class EquipmentManager {
    static equipment = [
        {
            id: 1,
            name: "–ü—Ä–µ—Å—Å –≥–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–∏–π",
            type: "–ü—Ä–µ—Å—Å",
            department: "–¶–µ—Ö ‚Ññ1",
            status: "operational",
            lastMaintenance: "2024-01-15",
            nextMaintenance: "2024-02-15",
            metrics: {
                temperature: "65¬∞C",
                pressure: "120 bar",
                cycles: "12,458"
            },
            utilization: 85
        },
        {
            id: 2,
            name: "–§—Ä–µ–∑–µ—Ä–Ω—ã–π —Å—Ç–∞–Ω–æ–∫",
            type: "–°—Ç–∞–Ω–æ–∫",
            department: "–¶–µ—Ö ‚Ññ2", 
            status: "maintenance",
            lastMaintenance: "2024-01-10",
            nextMaintenance: "2024-01-25",
            metrics: {
                temperature: "45¬∞C",
                vibration: "2.3 mm/s",
                hours: "1,234"
            },
            utilization: 60
        },
        {
            id: 3,
            name: "–ö–æ–Ω–≤–µ–π–µ—Ä–Ω–∞—è –ª–∏–Ω–∏—è",
            type: "–ö–æ–Ω–≤–µ–π–µ—Ä",
            department: "–¶–µ—Ö ‚Ññ1",
            status: "operational",
            lastMaintenance: "2024-01-18",
            nextMaintenance: "2024-02-18",
            metrics: {
                speed: "2.5 m/s",
                load: "85%",
                uptime: "99.2%"
            },
            utilization: 92
        },
        {
            id: 4,
            name: "–ü–µ—á—å —Ç–µ—Ä–º–æ–æ–±—Ä–∞–±–æ—Ç–∫–∏",
            type: "–ü–µ—á—å",
            department: "–¶–µ—Ö ‚Ññ3",
            status: "failed",
            lastMaintenance: "2024-01-05",
            nextMaintenance: "2024-01-20",
            metrics: {
                temperature: "0¬∞C",
                pressure: "0 bar",
                status: "–û—à–∏–±–∫–∞ T-104"
            },
            utilization: 0
        },
        {
            id: 5,
            name: "–†–æ–±–æ—Ç-–º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä",
            type: "–†–æ–±–æ—Ç",
            department: "–¶–µ—Ö ‚Ññ2",
            status: "standby",
            lastMaintenance: "2024-01-12",
            nextMaintenance: "2024-02-12",
            metrics: {
                accuracy: "0.02 mm",
                cycles: "8,765",
                battery: "95%"
            },
            utilization: 45
        },
        {
            id: 6,
            name: "–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä –≤–æ–∑–¥—É—à–Ω—ã–π",
            type: "–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä",
            department: "–¶–µ—Ö ‚Ññ3",
            status: "operational",
            lastMaintenance: "2024-01-20",
            nextMaintenance: "2024-02-20",
            metrics: {
                pressure: "8 bar",
                flow: "120 m¬≥/h",
                temperature: "75¬∞C"
            },
            utilization: 78
        }
    ];

    static stopEvents = [
        {
            id: 1,
            equipment_id: 2,
            equipment_name: "–§—Ä–µ–∑–µ—Ä–Ω—ã–π —Å—Ç–∞–Ω–æ–∫",
            type: "–ü–ª–∞–Ω–æ–≤–æ–µ –¢–û",
            start_time: "2024-01-22T08:00:00",
            end_time: null,
            duration: "2—á 15–º",
            status: "active",
            description: "–ó–∞–º–µ–Ω–∞ –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤ —à–ø–∏–Ω–¥–µ–ª—è"
        },
        {
            id: 2,
            equipment_id: 4,
            equipment_name: "–ü–µ—á—å —Ç–µ—Ä–º–æ–æ–±—Ä–∞–±–æ—Ç–∫–∏",
            type: "–ê–≤–∞—Ä–∏–π–Ω–∞—è",
            start_time: "2024-01-22T10:30:00",
            end_time: null,
            duration: "4—á 30–º",
            status: "active",
            description: "–û—à–∏–±–∫–∞ —Ç–µ—Ä–º–æ–ø–∞—Ä—ã T-104"
        },
        {
            id: 3,
            equipment_id: 1,
            equipment_name: "–ü—Ä–µ—Å—Å –≥–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–∏–π",
            type: "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è",
            start_time: "2024-01-21T14:20:00",
            end_time: "2024-01-21T15:45:00",
            duration: "1—á 25–º",
            status: "completed",
            description: "–ü–µ—Ä–µ–Ω–∞–ª–∞–¥–∫–∞ –Ω–∞ –Ω–æ–≤—É—é –¥–µ—Ç–∞–ª—å"
        }
    ];

    static maintenanceSchedule = [
        {
            id: 1,
            equipment_id: 3,
            equipment_name: "–ö–æ–Ω–≤–µ–π–µ—Ä–Ω–∞—è –ª–∏–Ω–∏—è",
            type: "–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –¢–û",
            scheduled_date: "2024-01-25",
            status: "scheduled",
            duration: "2 —á–∞—Å–∞"
        },
        {
            id: 2,
            equipment_id: 6,
            equipment_name: "–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä –≤–æ–∑–¥—É—à–Ω—ã–π",
            type: "–ú–µ—Å—è—á–Ω–æ–µ –¢–û",
            scheduled_date: "2024-01-26",
            status: "scheduled",
            duration: "4 —á–∞—Å–∞"
        },
        {
            id: 3,
            equipment_id: 1,
            equipment_name: "–ü—Ä–µ—Å—Å –≥–∏–¥—Ä–∞–≤–ª–∏—á–µ—Å–∫–∏–π",
            type: "–†–µ–≥–ª–∞–º–µ–Ω—Ç–Ω–æ–µ –¢–û",
            scheduled_date: "2024-02-15",
            status: "planned",
            duration: "8 —á–∞—Å–æ–≤"
        }
    ];

    static getEquipment() {
        return this.equipment;
    }

    static getEquipmentById(id) {
        return this.equipment.find(eq => eq.id === id);
    }

    static getStopEvents() {
        return this.stopEvents;
    }

    static getMaintenanceSchedule() {
        return this.maintenanceSchedule;
    }

    static updateEquipmentStatus(equipmentId, newStatus) {
        const equipment = this.getEquipmentById(equipmentId);
        if (equipment) {
            equipment.status = newStatus;
            return true;
        }
        return false;
    }

    static addStopEvent(event) {
        event.id = Math.max(...this.stopEvents.map(e => e.id)) + 1;
        this.stopEvents.unshift(event);
        return event;
    }

    static completeStopEvent(eventId) {
        const event = this.stopEvents.find(e => e.id === eventId);
        if (event) {
            event.status = 'completed';
            event.end_time = new Date().toISOString();
            return true;
        }
        return false;
    }
}

// ==================== –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–´–ô API –°–ï–†–í–ò–° ====================
class ApiService {
    static baseURL = 'http://localhost:8000/api';
    static token = localStorage.getItem('cmms_token');
    static isOnline = false;
    static cache = new Map();

    static async checkConnection() {
        // –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å —Ç–∞–π–º–∞—É—Ç–æ–º
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 2000);
        
        try {
            const response = await fetch(`${this.baseURL}/health/`, {
                method: 'GET',
                signal: controller.signal
            });
            clearTimeout(timeoutId);
            this.isOnline = response.ok;
            return this.isOnline;
        } catch (error) {
            clearTimeout(timeoutId);
            this.isOnline = false;
            return false;
        }
    }

    static async login(credentials) {
        // –°–Ω–∞—á–∞–ª–∞ –±—ã—Å—Ç—Ä–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
        const localResult = await this.fastLocalAuth(credentials);
        if (localResult) return localResult;

        // –ó–∞—Ç–µ–º –ø—Ä–æ–±—É–µ–º API —Å —Ç–∞–π–º–∞—É—Ç–æ–º
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 3000);

        try {
            const data = await this.request('/auth/login/', {
                method: 'POST',
                body: JSON.stringify(credentials),
                signal: controller.signal
            });
            
            clearTimeout(timeoutId);
            
            if (data && data.token) {
                this.token = data.token;
                localStorage.setItem('cmms_token', data.token);
                return data.user;
            }
            return null;
        } catch (error) {
            clearTimeout(timeoutId);
            return null;
        }
    }

    static async fastLocalAuth(credentials) {
        // –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
        const users = CMMSStorage.getUsers();
        const user = users[credentials.username];
        
        if (user && user.password === credentials.password) {
            const mockToken = 'mock_jwt_token_' + Date.now();
            this.token = mockToken;
            localStorage.setItem('cmms_token', mockToken);
            return { 
                id: credentials.username,
                username: credentials.username,
                role: user.role,
                firstLogin: user.firstLogin,
                fullName: user.fullName
            };
        }
        return null;
    }

    static async request(endpoint, options = {}) {
        // –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        await this.checkConnection();
        this.updateApiStatus();

        if (!this.isOnline) {
            return await this.fallbackToLocalStorage(endpoint, options);
        }

        const url = `${this.baseURL}${endpoint}`;
        const config = {
            headers: {
                'Content-Type': 'application/json',
                ...(this.token && { 'Authorization': `Bearer ${this.token}` })
            },
            ...options
        };

        try {
            const response = await fetch(url, config);
            
            if (response.status === 401) {
                this.handleUnauthorized();
                return null;
            }

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            return await response.json();
        } catch (error) {
            console.error('API request failed:', error);
            return await this.fallbackToLocalStorage(endpoint, options);
        }
    }

    static async fallbackToLocalStorage(endpoint, options) {
        const method = options.method || 'GET';
        
        switch(endpoint) {
            case '/training/':
                if (method === 'GET') {
                    return CMMSStorage.getTrainingData();
                } else if (method === 'POST') {
                    const data = JSON.parse(options.body);
                    CMMSStorage.saveTrainingData(data);
                    return { success: true, source: 'local' };
                }
                break;

            case '/test-results/':
                if (method === 'GET') {
                    const results = CMMSStorage.getTestResults();
                    return results.map(r => ({...r, source: 'local'}));
                } else if (method === 'POST') {
                    const result = JSON.parse(options.body);
                    CMMSStorage.saveTestResult(result);
                    return { success: true, source: 'local' };
                }
                break;

            case '/equipment/':
                return EquipmentManager.getEquipment();

            case '/stop-events/':
                return EquipmentManager.getStopEvents();

            case '/maintenance-schedule/':
                return EquipmentManager.getMaintenanceSchedule();

            case '/equipment/update-status/':
                if (method === 'POST') {
                    const body = JSON.parse(options.body);
                    return EquipmentManager.updateEquipmentStatus(body.equipmentId, body.status);
                }
                break;

            case '/stop-events/create/':
                if (method === 'POST') {
                    const body = JSON.parse(options.body);
                    return EquipmentManager.addStopEvent(body);
                }
                break;

            case '/stop-events/complete/':
                if (method === 'POST') {
                    const body = JSON.parse(options.body);
                    return EquipmentManager.completeStopEvent(body.eventId);
                }
                break;
        }

        return null;
    }

    static handleUnauthorized() {
        localStorage.removeItem('cmms_token');
        this.token = null;
        ScreenManager.show('login-screen');
        alert('–°–µ—Å—Å–∏—è –∏—Å—Ç–µ–∫–ª–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ —Å–Ω–æ–≤–∞.');
    }

    static updateApiStatus() {
        const statusElement = document.getElementById('api-status');
        const badgeElement = document.getElementById('api-status-badge');
        
        if (this.isOnline) {
            statusElement.className = 'api-status api-online';
            statusElement.textContent = 'API: –û–Ω–ª–∞–π–Ω';
            if (badgeElement) {
                badgeElement.className = 'status-operational';
                badgeElement.textContent = '–ü–æ–¥–∫–ª—é—á–µ–Ω';
                badgeElement.style.background = 'rgba(16,185,129,0.2)';
            }
        } else {
            statusElement.className = 'api-status api-offline';
            statusElement.textContent = 'API: –û—Ñ—Ñ–ª–∞–π–Ω';
            if (badgeElement) {
                badgeElement.className = 'status-failed';
                badgeElement.textContent = '–û—Ç–∫–ª—é—á–µ–Ω';
                badgeElement.style.background = 'rgba(239,68,68,0.2)';
            }
        }
    }

    // API –º–µ—Ç–æ–¥—ã
    static async getTrainingData() {
        return await this.request('/training/');
    }

    static async saveTrainingData(trainingData) {
        return await this.request('/training/', {
            method: 'POST',
            body: JSON.stringify(trainingData)
        });
    }

    static async getTestResults() {
        return await this.request('/test-results/');
    }

    static async saveTestResult(result) {
        return await this.request('/test-results/', {
            method: 'POST',
            body: JSON.stringify(result)
        });
    }

    static async getEquipment() {
        return await this.request('/equipment/');
    }

    static async getStopEvents() {
        return await this.request('/stop-events/');
    }

    static async getMaintenanceSchedule() {
        return await this.request('/maintenance-schedule/');
    }

    static async updateEquipmentStatus(equipmentId, status) {
        return await this.request('/equipment/update-status/', {
            method: 'POST',
            body: JSON.stringify({ equipmentId, status })
        });
    }

    static async createStopEvent(eventData) {
        return await this.request('/stop-events/create/', {
            method: 'POST',
            body: JSON.stringify(eventData)
        });
    }

    static async completeStopEvent(eventId) {
        return await this.request('/stop-events/complete/', {
            method: 'POST',
            body: JSON.stringify({ eventId })
        });
    }
}

// ==================== –£–ü–†–ê–í–õ–ï–ù–ò–ï –≠–ö–†–ê–ù–ê–ú–ò ====================
class ScreenManager {
    static show(screenId) {
        document.querySelectorAll('.screen').forEach(screen => {
            screen.classList.remove('active');
        });
        document.getElementById(screenId).classList.add('active');
    }
}

// ==================== –£–ü–†–ê–í–õ–ï–ù–ò–ï –†–ê–ë–û–ß–ò–ú –û–ö–ù–û–ú ====================
class WorkspaceManager {
    static currentTab = 'equipment-tab';

    static async initializeWorkspace() {
        await this.loadEquipmentData();
        await this.loadStopEvents();
        await this.loadMaintenanceSchedule();
        this.updateStatistics();
        this.checkAlerts();
    }

    static async loadEquipmentData() {
        const equipment = await ApiService.getEquipment();
        this.renderEquipmentList(equipment);
    }

    static async loadStopEvents() {
        const events = await ApiService.getStopEvents();
        this.renderStopEvents(events);
    }

    static async loadMaintenanceSchedule() {
        const schedule = await ApiService.getMaintenanceSchedule();
        this.renderMaintenanceSchedule(schedule);
    }

    static renderEquipmentList(equipment) {
        const container = document.getElementById('equipment-list');
        
        container.innerHTML = equipment.map(eq => `
            <div class="equipment-card ${eq.status}" data-id="${eq.id}" data-department="${eq.department}">
                <div class="equipment-header">
                    <div class="equipment-name">${eq.name}</div>
                    <div class="equipment-status status-${eq.status}">
                        ${this.getStatusText(eq.status)}
                    </div>
                </div>
                <div style="color: #94a3b8; font-size: 14px; margin-bottom: 10px;">
                    ${eq.type} ‚Ä¢ ${eq.department} ‚Ä¢ –ó–∞–≥—Ä—É–∑–∫–∞: ${eq.utilization}%
                </div>
                
                <div class="metrics-grid">
                    ${Object.entries(eq.metrics).map(([key, value]) => `
                        <div class="metric">
                            <div class="metric-value">${value}</div>
                            <div class="metric-label">${this.getMetricLabel(key)}</div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="action-buttons">
                    ${this.getActionButtons(eq)}
                </div>
            </div>
        `).join('');
    }

    static getMetricLabel(key) {
        const labels = {
            temperature: '–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞',
            pressure: '–î–∞–≤–ª–µ–Ω–∏–µ',
            cycles: '–¶–∏–∫–ª—ã',
            vibration: '–í–∏–±—Ä–∞—Ü–∏—è',
            hours: '–ß–∞—Å—ã',
            speed: '–°–∫–æ—Ä–æ—Å—Ç—å',
            load: '–ù–∞–≥—Ä—É–∑–∫–∞',
            uptime: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            accuracy: '–¢–æ—á–Ω–æ—Å—Ç—å',
            battery: '–ë–∞—Ç–∞—Ä–µ—è',
            flow: '–†–∞—Å—Ö–æ–¥',
            status: '–°—Ç–∞—Ç—É—Å'
        };
        return labels[key] || key;
    }

    static getStatusText(status) {
        const statusMap = {
            operational: '–í —Ä–∞–±–æ—Ç–µ',
            maintenance: '–ù–∞ –¢–û',
            failed: '–ù–µ–∏—Å–ø—Ä–∞–≤–Ω–æ',
            standby: '–†–µ–∑–µ—Ä–≤'
        };
        return statusMap[status] || status;
    }

    static getActionButtons(equipment) {
        const baseButtons = `
            <button class="action-btn btn-secondary" onclick="showEquipmentDetails(${equipment.id})">üìã –î–µ—Ç–∞–ª–∏</button>
        `;

        if (equipment.status === 'operational') {
            return baseButtons + `
                <button class="action-btn btn-warning" onclick="startMaintenance(${equipment.id})">üîß –¢–û</button>
                <button class="action-btn btn-danger" onclick="reportFailure(${equipment.id})">‚ö†Ô∏è –ê–≤–∞—Ä–∏—è</button>
            `;
        } else if (equipment.status === 'maintenance') {
            return baseButtons + `
                <button class="action-btn btn-success" onclick="completeMaintenance(${equipment.id})">‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å –¢–û</button>
            `;
        } else if (equipment.status === 'failed') {
            return baseButtons + `
                <button class="action-btn btn-success" onclick="repairEquipment(${equipment.id})">üîß –†–µ–º–æ–Ω—Ç</button>
            `;
        }

        return baseButtons;
    }

    static renderStopEvents(events) {
        const container = document.getElementById('stops-history');
        
        container.innerHTML = events.map(event => `
            <tr>
                <td>${event.equipment_name}</td>
                <td>${event.type}</td>
                <td>${new Date(event.start_time).toLocaleString('ru-RU')}</td>
                <td>${event.duration}</td>
                <td><span class="status-${event.status}">${event.status === 'active' ? '–ê–∫—Ç–∏–≤–Ω–æ' : '–ó–∞–≤–µ—Ä—à–µ–Ω–æ'}</span></td>
                <td>
                    ${event.status === 'active' ? 
                        `<button class="action-btn btn-success" onclick="completeStopEvent(${event.id})">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>` : 
                        '<span>‚Äî</span>'
                    }
                </td>
            </tr>
        `).join('');
    }

    static renderMaintenanceSchedule(schedule) {
        const container = document.getElementById('maintenance-schedule');
        
        container.innerHTML = schedule.map(item => `
            <div class="schedule-item">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <strong>${item.equipment_name}</strong>
                        <div style="color: #94a3b8; font-size: 12px;">${item.type} ‚Ä¢ ${item.duration}</div>
                    </div>
                    <div>
                        <span class="status-${item.status}">${this.getScheduleStatusText(item.status)}</span>
                        <div style="color: #94a3b8; font-size: 12px; text-align: right;">${new Date(item.scheduled_date).toLocaleDateString('ru-RU')}</div>
                    </div>
                </div>
            </div>
        `).join('');
    }

    static getScheduleStatusText(status) {
        const statusMap = {
            scheduled: '–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ',
            active: '–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è',
            completed: '–ó–∞–≤–µ—Ä—à–µ–Ω–æ',
            planned: '–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è'
        };
        return statusMap[status] || status;
    }

    static updateStatistics() {
        const equipment = EquipmentManager.getEquipment();
        const total = equipment.length;
        const operational = equipment.filter(eq => eq.status === 'operational').length;
        const maintenance = equipment.filter(eq => eq.status === 'maintenance').length;
        const failed = equipment.filter(eq => eq.status === 'failed').length;

        document.getElementById('total-equipment').textContent = total;
        document.getElementById('operational-count').textContent = operational;
        document.getElementById('maintenance-count').textContent = maintenance;
        document.getElementById('failed-count').textContent = failed;
    }

    static checkAlerts() {
        const alerts = [];
        const equipment = EquipmentManager.getEquipment();
        const stopEvents = EquipmentManager.getStopEvents();

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–∏
        const criticalFailures = equipment.filter(eq => eq.status === 'failed');
        if (criticalFailures.length > 0) {
            alerts.push({
                type: 'critical',
                message: `–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ ${criticalFailures.length} –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è`,
                equipment: criticalFailures
            });
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∞–≤–∞—Ä–∏–π–Ω—ã–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
        const activeEmergencyStops = stopEvents.filter(event => 
            event.status === 'active' && event.type === '–ê–≤–∞—Ä–∏–π–Ω–∞—è'
        );
        if (activeEmergencyStops.length > 0) {
            alerts.push({
                type: 'warning',
                message: `–ê–∫—Ç–∏–≤–Ω—ã–µ –∞–≤–∞—Ä–∏–π–Ω—ã–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏: ${activeEmergencyStops.length}`,
                events: activeEmergencyStops
            });
        }

        this.renderAlerts(alerts);
    }

    static renderAlerts(alerts) {
        const container = document.getElementById('alerts-container');
        
        if (alerts.length === 0) {
            container.innerHTML = '';
            return;
        }

        container.innerHTML = alerts.map(alert => `
            <div class="alert-banner ${alert.type === 'critical' ? '' : 'warning'}">
                <div>
                    <strong>${alert.type === 'critical' ? 'üö® –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –°–û–ë–´–¢–ò–ï' : '‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï'}</strong>
                    <div>${alert.message}</div>
                </div>
                <button class="action-btn" onclick="this.parentElement.remove()">‚úï</button>
            </div>
        `).join('');
    }
}

// ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
let currentUser = null;
let currentTest = {
    questions: [],
    currentQuestionIndex: 0,
    userAnswers: []
};

// ==================== –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –í–•–û–î–ê ====================
async function handleLogin() {
    const login = document.getElementById('login').value.trim();
    const password = document.getElementById('password').value.trim();

    // –ë—ã—Å—Ç—Ä–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    if (!login || !password) {
        document.getElementById('login-msg').textContent = '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è';
        return;
    }

    // –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫ UI
    const loginBtn = document.getElementById('login-btn');
    loginBtn.classList.add('loading');
    loginBtn.textContent = '–í—Ö–æ–¥...';

    try {
        // –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
        const [apiUser, localUsers] = await Promise.all([
            ApiService.login({ username: login, password }),
            CMMSStorage.getUsers()
        ]);

        // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –±—ã—Å—Ç—Ä—ã–π API –æ—Ç–≤–µ—Ç
        if (apiUser) {
            currentUser = apiUser;
            handleSuccessfulLogin();
            return;
        }

        // –ó–∞—Ç–µ–º –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        if (!localUsers[login] || localUsers[login].password !== password) {
            document.getElementById('login-msg').textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å';
            return;
        }

        currentUser = { 
            login, 
            ...localUsers[login],
            id: login
        };
        handleSuccessfulLogin();

    } catch (error) {
        console.error('Login error:', error);
        document.getElementById('login-msg').textContent = '–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ';
    } finally {
        loginBtn.classList.remove('loading');
        loginBtn.textContent = '–í–æ–π—Ç–∏';
    }
}

function handleSuccessfulLogin() {
    // –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫
    if (currentUser.role === 'admin') {
        ScreenManager.show('admin-dashboard-screen');
        // –§–æ–Ω–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        setTimeout(() => loadAdminData(), 50);
    } else {
        if (currentUser.firstLogin) {
            loadStudyMaterials();
            ScreenManager.show('study-screen');
        } else {
            showWorkspace();
        }
    }
}

// –§–æ–Ω–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–¥–º–∏–Ω–∞
async function loadAdminData() {
    try {
        await Promise.allSettled([
            ApiService.getTrainingData(),
            ApiService.getTestResults()
        ]);
    } catch (error) {
        // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ —Ñ–æ–Ω–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
    }
}

// ==================== –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –û–ë–û–†–£–î–û–í–ê–ù–ò–ï–ú ====================
function switchTab(tabName) {
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
    });
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    
    document.getElementById(tabName).classList.add('active');
    event.target.classList.add('active');
    
    WorkspaceManager.currentTab = tabName;
}

function filterEquipment() {
    const departmentFilter = document.getElementById('department-filter').value;
    const statusFilter = document.getElementById('status-filter').value;
    
    const equipmentCards = document.querySelectorAll('.equipment-card');
    
    equipmentCards.forEach(card => {
        const department = card.getAttribute('data-department');
        const status = card.className.includes('operational') ? 'operational' :
                     card.className.includes('maintenance') ? 'maintenance' :
                     card.className.includes('failed') ? 'failed' : 'standby';
        
        const departmentMatch = !departmentFilter || department === departmentFilter;
        const statusMatch = !statusFilter || status === statusFilter;
        
        card.style.display = (departmentMatch && statusMatch) ? 'block' : 'none';
    });
}

async function startMaintenance(equipmentId) {
    if (confirm('–ù–∞—á–∞—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è?')) {
        const success = await ApiService.updateEquipmentStatus(equipmentId, 'maintenance');
        if (success) {
            const equipment = EquipmentManager.getEquipmentById(equipmentId);
            await ApiService.createStopEvent({
                equipment_id: equipmentId,
                equipment_name: equipment.name,
                type: '–ü–ª–∞–Ω–æ–≤–æ–µ –¢–û',
                start_time: new Date().toISOString(),
                status: 'active',
                description: '–ù–∞—á–∞–ª–æ –ø–ª–∞–Ω–æ–≤–æ–≥–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è'
            });
            
            alert('–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –Ω–∞—á–∞—Ç–æ');
            WorkspaceManager.initializeWorkspace();
        }
    }
}

async function completeMaintenance(equipmentId) {
    if (confirm('–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ?')) {
        const success = await ApiService.updateEquipmentStatus(equipmentId, 'operational');
        if (success) {
            alert('–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ');
            WorkspaceManager.initializeWorkspace();
        }
    }
}

async function reportFailure(equipmentId) {
    const reason = prompt('–ü—Ä–∏—á–∏–Ω–∞ –∞–≤–∞—Ä–∏–∏:');
    if (reason) {
        const success = await ApiService.updateEquipmentStatus(equipmentId, 'failed');
        if (success) {
            const equipment = EquipmentManager.getEquipmentById(equipmentId);
            await ApiService.createStopEvent({
                equipment_id: equipmentId,
                equipment_name: equipment.name,
                type: '–ê–≤–∞—Ä–∏–π–Ω–∞—è',
                start_time: new Date().toISOString(),
                status: 'active',
                description: reason
            });
            
            alert('–ê–≤–∞—Ä–∏—è –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞');
            WorkspaceManager.initializeWorkspace();
        }
    }
}

async function repairEquipment(equipmentId) {
    if (confirm('–û—Ç–º–µ—Ç–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∫–∞–∫ –æ—Ç—Ä–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ?')) {
        const success = await ApiService.updateEquipmentStatus(equipmentId, 'operational');
        if (success) {
            alert('–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–æ –≤ —Ä–∞–±–æ—á–∏–π —Ä–µ–∂–∏–º');
            WorkspaceManager.initializeWorkspace();
        }
    }
}

async function completeStopEvent(eventId) {
    if (confirm('–ó–∞–≤–µ—Ä—à–∏—Ç—å —ç—Ç—É –æ—Å—Ç–∞–Ω–æ–≤–∫—É?')) {
        const success = await ApiService.completeStopEvent(eventId);
        if (success) {
            alert('–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
            WorkspaceManager.initializeWorkspace();
        }
    }
}

function showEquipmentDetails(equipmentId) {
    const equipment = EquipmentManager.getEquipmentById(equipmentId);
    if (equipment) {
        alert(`–î–µ—Ç–∞–ª–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è:\n\n` +
              `–ù–∞–∑–≤–∞–Ω–∏–µ: ${equipment.name}\n` +
              `–¢–∏–ø: ${equipment.type}\n` +
              `–¶–µ—Ö: ${equipment.department}\n` +
              `–°—Ç–∞—Ç—É—Å: ${WorkspaceManager.getStatusText(equipment.status)}\n` +
              `–ü–æ—Å–ª–µ–¥–Ω–µ–µ –¢–û: ${equipment.lastMaintenance}\n` +
              `–°–ª–µ–¥—É—é—â–µ–µ –¢–û: ${equipment.nextMaintenance}\n` +
              `–ó–∞–≥—Ä—É–∑–∫–∞: ${equipment.utilization}%`);
    }
}

function addNewEquipment() {
    alert('–§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞');
}

function generateReport() {
    alert('–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞');
}

function showUserManagement() {
    alert('–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ');
}

function showSystemSettings() {
    alert('–°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—É–¥—É—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã');
}

// ==================== –°–ò–°–¢–ï–ú–ê –û–ë–£–ß–ï–ù–ò–Ø ====================
function loadStudyMaterials() {
    const trainingData = CMMSStorage.getTrainingData();
    document.getElementById('study-content').innerHTML = `
        <div style="white-space: pre-wrap; line-height: 1.5;">${trainingData.material}</div>
    `;
}

function startEmployeeTest() {
    const trainingData = CMMSStorage.getTrainingData();
    
    if (trainingData.questions.length === 0) {
        alert('–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –µ—â–µ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–∏–ª –≤–æ–ø—Ä–æ—Å—ã —Ç–µ—Å—Ç–∞');
        return;
    }

    currentTest = {
        questions: trainingData.questions,
        currentQuestionIndex: 0,
        userAnswers: []
    };

    ScreenManager.show('test-screen');
    showCurrentQuestion();
}

function showCurrentQuestion() {
    const question = currentTest.questions[currentTest.currentQuestionIndex];
    document.getElementById('question-text').textContent = question.text;
    document.getElementById('test-progress').textContent = 
        `–í–æ–ø—Ä–æ—Å ${currentTest.currentQuestionIndex + 1} –∏–∑ ${currentTest.questions.length}`;
    document.getElementById('answer-input').value = '';
}

function handleNextQuestion() {
    const answer = document.getElementById('answer-input').value.trim();
    
    if (!answer) {
        document.getElementById('test-msg').textContent = '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç';
        return;
    }

    currentTest.userAnswers.push(answer);
    currentTest.currentQuestionIndex++;
    
    if (currentTest.currentQuestionIndex < currentTest.questions.length) {
        showCurrentQuestion();
    } else {
        completeTest();
    }
}

async function completeTest() {
    const users = CMMSStorage.getUsers();
    
    users[currentUser.login].firstLogin = false;
    CMMSStorage.saveUsers(users);
    
    const trainingData = CMMSStorage.getTrainingData();
    let correctAnswers = 0;
    
    currentTest.userAnswers.forEach((answer, index) => {
        if (answer.toLowerCase() === trainingData.questions[index].correctAnswer.toLowerCase()) {
            correctAnswers++;
        }
    });

    const testResult = {
        user: currentUser.login,
        date: new Date().toLocaleDateString('ru-RU'),
        score: `${correctAnswers}/${trainingData.questions.length}`,
        status: correctAnswers >= trainingData.questions.length * 0.7 ? '–°–¥–∞–Ω' : '–ù–µ —Å–¥–∞–Ω'
    };

    await ApiService.saveTestResult(testResult);
    showWorkspace();
}

async function showWorkspace() {
    document.getElementById('current-user-role').textContent = 
        currentUser.role === 'admin' ? 'üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' : '‚öôÔ∏è –ò–Ω–∂–µ–Ω–µ—Ä';
    
    const adminFeatures = document.getElementById('admin-workspace-features');
    adminFeatures.style.display = currentUser.role === 'admin' ? 'block' : 'none';
    
    ScreenManager.show('workspace-screen');
    
    await WorkspaceManager.initializeWorkspace();
}

async function showResults() {
    ScreenManager.show('results-screen');
    
    document.getElementById('results-loading').style.display = 'block';
    document.getElementById('results-table').style.display = 'none';
    
    const results = await ApiService.getTestResults();
    
    document.getElementById('results-loading').style.display = 'none';
    document.getElementById('results-table').style.display = 'table';
    
    updateResultsUI(results);
}

function updateResultsUI(results) {
    const tbody = document.getElementById('results-body');
    
    tbody.innerHTML = results.map(result => `
        <tr>
            <td>${result.user}</td>
            <td>${result.date}</td>
            <td>${result.score}</td>
            <td>${result.status}</td>
            <td>${result.source === 'local' ? 'üì± –õ–æ–∫–∞–ª—å–Ω–æ' : 'üåê –°–µ—Ä–≤–µ—Ä'}</td>
        </tr>
    `).join('');
}

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
function loadQuestions() {
    const questionsContainer = document.getElementById('questions-container');
    const trainingData = CMMSStorage.getTrainingData();
    
    questionsContainer.innerHTML = '';
    trainingData.questions.forEach((question, index) => {
        addQuestionToUI(question, index);
    });
}

function addNewQuestion() {
    const trainingData = CMMSStorage.getTrainingData();
    if (trainingData.questions.length >= 10) {
        alert('–ú–∞–∫—Å–∏–º—É–º 10 –≤–æ–ø—Ä–æ—Å–æ–≤');
        return;
    }
    
    const newQuestion = { text: '', correctAnswer: '' };
    trainingData.questions.push(newQuestion);
    addQuestionToUI(newQuestion, trainingData.questions.length - 1);
}

function addQuestionToUI(question, index) {
    const questionsContainer = document.getElementById('questions-container');
    const questionDiv = document.createElement('div');
    questionDiv.className = 'question-item';
    questionDiv.innerHTML = `
        <strong>–í–æ–ø—Ä–æ—Å ${index + 1}:</strong>
        <input type="text" class="question-text" data-index="${index}" 
               placeholder="–¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞" value="${question.text}">
        <input type="text" class="question-answer" data-index="${index}" 
               placeholder="–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç" value="${question.correctAnswer}">
        <button class="btn-danger remove-question" data-index="${index}">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
    `;
    questionsContainer.appendChild(questionDiv);

    questionDiv.querySelector('.remove-question').addEventListener('click', function() {
        const index = parseInt(this.getAttribute('data-index'));
        const trainingData = CMMSStorage.getTrainingData();
        trainingData.questions.splice(index, 1);
        loadQuestions();
    });
}

async function saveTrainingData() {
    const trainingData = {
        material: document.getElementById('training-material').value,
        questions: []
    };

    document.querySelectorAll('.question-text').forEach(input => {
        const index = parseInt(input.getAttribute('data-index'));
        if (!trainingData.questions[index]) trainingData.questions[index] = {};
        trainingData.questions[index].text = input.value;
    });

    document.querySelectorAll('.question-answer').forEach(input => {
        const index = parseInt(input.getAttribute('data-index'));
        if (!trainingData.questions[index]) trainingData.questions[index] = {};
        trainingData.questions[index].correctAnswer = input.value;
    });

    const apiResult = await ApiService.saveTrainingData(trainingData);
    
    if (apiResult && apiResult.success) {
        alert(`‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã (${apiResult.source === 'local' ? '–ª–æ–∫–∞–ª—å–Ω–æ' : '–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ'})!`);
    } else {
        CMMSStorage.saveTrainingData(trainingData);
        alert('‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ!');
    }
}

function logout() {
    currentUser = null;
    ScreenManager.show('login-screen');
    document.getElementById('login').value = '';
    document.getElementById('password').value = '';
    document.getElementById('login-msg').textContent = '';
}

// ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
function initializeLoginSystem() {
    document.getElementById('login-btn').addEventListener('click', handleLogin);
    document.getElementById('logout-admin').addEventListener('click', logout);
    document.getElementById('logout-study').addEventListener('click', logout);
    document.getElementById('logout-workspace').addEventListener('click', logout);
    document.getElementById('start-test-btn').addEventListener('click', startEmployeeTest);
    document.getElementById('next-question-btn').addEventListener('click', handleNextQuestion);
    document.getElementById('admin-setup-btn').addEventListener('click', () => ScreenManager.show('admin-setup-screen'));
    document.getElementById('admin-workspace-btn').addEventListener('click', showWorkspace);
    document.getElementById('view-results-btn').addEventListener('click', showResults);
    document.getElementById('back-to-admin-dashboard').addEventListener('click', () => ScreenManager.show('admin-dashboard-screen'));
    document.getElementById('back-to-admin-from-results').addEventListener('click', () => ScreenManager.show('admin-dashboard-screen'));
    document.getElementById('manage-users-btn').addEventListener('click', showUserManagement);
    document.getElementById('system-status-btn').addEventListener('click', showSystemSettings);
    document.getElementById('add-question-btn').addEventListener('click', addNewQuestion);
    document.getElementById('save-training-btn').addEventListener('click', saveTrainingData);

    loadQuestions();
}

document.addEventListener('DOMContentLoaded', function() {
    initializeLoginSystem();
    
    // –§–æ–Ω–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
    setTimeout(() => {
        ApiService.checkConnection().then(() => {
            ApiService.updateApiStatus();
        });
    }, 100);
});
</script>
</body>
</html>
